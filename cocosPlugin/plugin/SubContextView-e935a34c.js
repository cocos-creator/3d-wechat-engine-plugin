System.register(["./deprecated-0768b3d4.js","./deprecated-4df5f565.js","./index-7375b6c6.js","./deprecated-ffd97385.js","./screen-f991c158.js","./label-e9b775fb.js","./graphics-5a29dbec.js"],(function(t){"use strict";var e,i,o,n,r,s,a,h,l,c,u,_,p,d,f,g,y,m,T,v,b,S,C,E,O,w,L,A,D,P,x,I,z,R,B,M,H,N,k,F,V,U,G,W,j,X,Y,Z,$,q,K,Q,J,tt,et,it,ot,nt,rt,st,at,ht,lt,ct,ut,_t,pt,dt,ft,gt,yt,mt,Tt,vt,bt,St,Ct,Et,Ot,wt,Lt,At,Dt,Pt,xt,It,zt,Rt,Bt,Mt,Ht,Nt,kt,Ft,Vt,Ut,Gt,Wt,jt,Xt,Yt,Zt,$t,qt,Kt;return{setters:[function(t){e=t.aa,i=t.S,o=t.c,n=t.t,r=t.b5,s=t._,a=t.ag,h=t.V,l=t.a,c=t.b,u=t.h,_=t.m,p=t.b6,d=t.d,f=t.b3,g=t.b4,y=t.e,m=t.f,T=t.C,v=t.s,b=t.E,S=t.a3,C=t.l,E=t.c7,O=t.i,w=t.aU,L=t.a6,A=t.a8,D=t.W,P=t.bA,x=t.o,I=t.bh,z=t.r,R=t.y,B=t.g,M=t.af,H=t.w,N=t.aX,k=t.Q,F=t.c8,V=t.aL,U=t.x,G=t.T,W=t.c9,j=t.bC},function(t){X=t.dQ,Y=t.bN,Z=t.b_,$=t.d$,q=t.e5,K=t.e6,Q=t.e4,J=t.bQ,tt=t.c0,et=t.e3,it=t.dU,ot=t.ak,nt=t.K,rt=t.B,st=t.b,at=t.M,ht=t.bL,lt=t.P,ct=t.b$,ut=t.by,_t=t.bx,pt=t.br,dt=t.bu,ft=t.bv,gt=t.bW,yt=t.ea,mt=t.bO,Tt=t.bG},function(){},function(t){vt=t.E,bt=t.U,St=t.h,Ct=t.c,Et=t.g,Ot=t.I,wt=t.p,Lt=t.q,At=t.s,Dt=t.m,Pt=t.F,xt=t.a,It=t.b,zt=t.i,Rt=t.t,Bt=t.w,Mt=t.x,Ht=t.y,Nt=t.W,kt=t.z,Ft=t.G,Vt=t.H,Ut=t.K,Gt=t.k,Wt=t.o},function(t){jt=t.s},function(t){Xt=t.S,Yt=t.L,Zt=t.V,$t=t.H,qt=t.C},function(t){Kt=t.G}],execute:function(){var Qt,Jt,te,ee,ie,oe,ne,re,se,ae,he,le,ce,ue,_e,pe,de,fe,ge,ye,me,Te,ve,be,Se,Ce,Ee,Oe,we,Le,Ae,De,Pe,xe,Ie,ze,Re,Be,Me,He,Ne,ke,Fe,Ve,Ue,Ge,We,je,Xe,Ye;t("b",void 0);var Ze,$e,qe,Ke=new e;!function(t){t[t.NONE=0]="NONE",t[t.COLOR=1]="COLOR",t[t.SPRITE=2]="SPRITE",t[t.SCALE=3]="SCALE"}(Ze||(Ze={})),i(Ze),function(t){t.NORMAL="normal",t.HOVER="hover",t.PRESSED="pressed",t.DISABLED="disabled"}($e||($e={})),function(t){t.CLICK="click"}(qe||(qe={}));var Qe,Je,ti,ei=t("B",(Qt=o("cc.Button"),Jt=u(),te=q(110),ee=_(),ie=K(Q),oe=n(X),ne=p(),re=d(),se=p(),ae=d(),he=n(Ze),le=p(),ce=d(),ue=d(),_e=d(),pe=d(),de=d(),fe=f(),ge=g(),ye=d(),me=d(),Te=n(Y),ve=d(),be=n(Y),Se=d(),Ce=n(Y),Ee=d(),Oe=n(Y),we=d(),Le=n([vt]),Ae=p(),De=d(),Qt(Pe=Jt(Pe=te(Pe=ee(Pe=ie(Pe=r((Ye=Xe=function(t){function i(){for(var i,o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];return i=t.call.apply(t,[this].concat(n))||this,y(i,"clickEvents",Ie,m(i)),y(i,"_interactable",ze,m(i)),y(i,"_transition",Re,m(i)),y(i,"_normalColor",Be,m(i)),y(i,"_hoverColor",Me,m(i)),y(i,"_pressedColor",He,m(i)),y(i,"_disabledColor",Ne,m(i)),y(i,"_normalSprite",ke,m(i)),y(i,"_hoverSprite",Fe,m(i)),y(i,"_pressedSprite",Ve,m(i)),y(i,"_disabledSprite",Ue,m(i)),y(i,"_duration",Ge,m(i)),y(i,"_zoomScale",We,m(i)),y(i,"_target",je,m(i)),i._pressed=!1,i._hovered=!1,i._fromColor=new e,i._toColor=new e,i._time=0,i._transitionFinished=!0,i._fromScale=new h,i._toScale=new h,i._originalScale=null,i._sprite=null,i._targetScale=new h,i}s(i,t);var o=i.prototype;return o.__preload=function(){this.target||(this.target=this.node);var t=this.node.getComponent(Xt);t&&(this._normalSprite=t.spriteFrame),this._applyTarget(),this._resetState()},o.onEnable=function(){this.node.on(Z.TOUCH_START,this._onTouchBegan,this),this.node.on(Z.TOUCH_MOVE,this._onTouchMove,this),this.node.on(Z.TOUCH_END,this._onTouchEnded,this),this.node.on(Z.TOUCH_CANCEL,this._onTouchCancel,this),this.node.on(Z.MOUSE_ENTER,this._onMouseMoveIn,this),this.node.on(Z.MOUSE_LEAVE,this._onMouseMoveOut,this)},o.onDisable=function(){this._resetState(),this.node.off(Z.TOUCH_START,this._onTouchBegan,this),this.node.off(Z.TOUCH_MOVE,this._onTouchMove,this),this.node.off(Z.TOUCH_END,this._onTouchEnded,this),this.node.off(Z.TOUCH_CANCEL,this._onTouchCancel,this),this.node.off(Z.MOUSE_ENTER,this._onMouseMoveIn,this),this.node.off(Z.MOUSE_LEAVE,this._onMouseMoveOut,this)},o.update=function(t){var i=this.target;if(!this._transitionFinished&&i&&(this._transition===Ze.COLOR||this._transition===Ze.SCALE)){this._time+=t;var o=1;if(this._duration>0&&(o=this._time/this._duration),o>=1&&(o=1),this._transition===Ze.COLOR){var n=i._uiProps.uiComp;e.lerp(Ke,this._fromColor,this._toColor,o),n&&(n.color=Ke)}else this.transition===Ze.SCALE&&(i.getScale(this._targetScale),this._targetScale.x=a(this._fromScale.x,this._toScale.x,o),this._targetScale.y=a(this._fromScale.y,this._toScale.y,o),i.setScale(this._targetScale));1===o&&(this._transitionFinished=!0)}},o._resizeNodeToTargetNode=function(){this.target&&this.target._uiProps.uiTransformComp},o._resetState=function(){this._pressed=!1,this._hovered=!1;var t=this.target;if(t){var e=t.getComponent(bt);if(e){var i=this._transition;i===Ze.COLOR&&this._interactable?e.color=this._normalColor:i===Ze.SCALE&&this._originalScale&&t.setScale(this._originalScale),this._transitionFinished=!0}}},o._registerNodeEvent=function(){this.node.on(Z.TOUCH_START,this._onTouchBegan,this),this.node.on(Z.TOUCH_MOVE,this._onTouchMove,this),this.node.on(Z.TOUCH_END,this._onTouchEnded,this),this.node.on(Z.TOUCH_CANCEL,this._onTouchCancel,this),this.node.on(Z.MOUSE_ENTER,this._onMouseMoveIn,this),this.node.on(Z.MOUSE_LEAVE,this._onMouseMoveOut,this)},o._registerTargetEvent=function(t){t.on(Z.TRANSFORM_CHANGED,this._onTargetTransformChanged,this)},o._unregisterNodeEvent=function(){this.node.off(Z.TOUCH_START,this._onTouchBegan,this),this.node.off(Z.TOUCH_MOVE,this._onTouchMove,this),this.node.off(Z.TOUCH_END,this._onTouchEnded,this),this.node.off(Z.TOUCH_CANCEL,this._onTouchCancel,this),this.node.off(Z.MOUSE_ENTER,this._onMouseMoveIn,this),this.node.off(Z.MOUSE_LEAVE,this._onMouseMoveOut,this)},o._unregisterTargetEvent=function(t){t.off(Z.TRANSFORM_CHANGED)},o._getTargetSprite=function(t){var e=null;return t&&(e=t.getComponent(Xt)),e},o._applyTarget=function(){this.target&&(this._sprite=this._getTargetSprite(this.target),this._originalScale||(this._originalScale=new h),h.copy(this._originalScale,this.target.getScale()))},o._onTargetSpriteFrameChanged=function(t){this._transition===Ze.SPRITE&&this._setCurrentStateSpriteFrame(t.spriteFrame)},o._setCurrentStateSpriteFrame=function(t){if(t)switch(this._getButtonState()){case $e.NORMAL:this._normalSprite=t;break;case $e.HOVER:this._hoverSprite=t;break;case $e.PRESSED:this._pressedSprite=t;break;case $e.DISABLED:this._disabledSprite=t}},o._onTargetColorChanged=function(t){this._transition===Ze.COLOR&&this._setCurrentStateColor(t)},o._setCurrentStateColor=function(t){switch(this._getButtonState()){case $e.NORMAL:this._normalColor=t;break;case $e.HOVER:this._hoverColor=t;break;case $e.PRESSED:this._pressedColor=t;break;case $e.DISABLED:this._disabledColor=t}},o._onTargetTransformChanged=function(t){t|$.SCALE&&this._originalScale&&this._transition===Ze.SCALE&&this._transitionFinished&&h.copy(this._originalScale,this.target.getScale())},o._onTouchBegan=function(t){this._interactable&&this.enabledInHierarchy&&(this._pressed=!0,this._updateState(),t&&(t.propagationStopped=!0))},o._onTouchMove=function(t){if(this._interactable&&this.enabledInHierarchy&&this._pressed){if(!t)return!1;var e=t.touch;if(!e)return!1;var i,o=this.node._uiProps.uiTransformComp.isHit(e.getUILocation());this._transition===Ze.SCALE&&this.target&&this._originalScale?o?(h.copy(this._fromScale,this._originalScale),h.multiplyScalar(this._toScale,this._originalScale,this._zoomScale),this._transitionFinished=!1):(this._time=0,this._transitionFinished=!0,this.target.setScale(this._originalScale)):(i=o?$e.PRESSED:$e.NORMAL,this._applyTransition(i)),t&&(t.propagationStopped=!0)}},o._onTouchEnded=function(t){this._interactable&&this.enabledInHierarchy&&(this._pressed&&(vt.emitEvents(this.clickEvents,t),this.node.emit(qe.CLICK,this)),this._pressed=!1,this._updateState(),t&&(t.propagationStopped=!0))},o._onTouchCancel=function(){this._interactable&&this.enabledInHierarchy&&(this._pressed=!1,this._updateState())},o._onMouseMoveIn=function(){!this._pressed&&this.interactable&&this.enabledInHierarchy&&(this._transition!==Ze.SPRITE||this._hoverSprite)&&(this._hovered||(this._hovered=!0,this._updateState()))},o._onMouseMoveOut=function(){this._hovered&&(this._hovered=!1,this._updateState())},o._updateState=function(){var t=this._getButtonState();this._applyTransition(t)},o._getButtonState=function(){var t=$e.NORMAL;return this._interactable?this._pressed?t=$e.PRESSED:this._hovered&&(t=$e.HOVER):t=$e.DISABLED,t.toString()},o._updateColorTransition=function(t){var e,i=this[t+"Color"],o=null===(e=this.target)||void 0===e?void 0:e.getComponent(bt);o&&(t===$e.DISABLED?o.color=i:(this._fromColor=o.color.clone(),this._toColor=i,this._time=0,this._transitionFinished=!1))},o._updateSpriteTransition=function(t){var e=this[t+"Sprite"];this._sprite&&e&&(this._sprite.spriteFrame=e)},o._updateScaleTransition=function(t){this._interactable&&(t===$e.PRESSED?this._zoomUp():this._zoomBack())},o._zoomUp=function(){this._originalScale&&(h.copy(this._fromScale,this._originalScale),h.multiplyScalar(this._toScale,this._originalScale,this._zoomScale),this._time=0,this._transitionFinished=!1)},o._zoomBack=function(){this.target&&this._originalScale&&(h.copy(this._fromScale,this.target.getScale()),h.copy(this._toScale,this._originalScale),this._time=0,this._transitionFinished=!1)},o._applyTransition=function(t){var e=this._transition;e===Ze.COLOR?this._updateColorTransition(t):e===Ze.SPRITE?this._updateSpriteTransition(t):e===Ze.SCALE&&this._updateScaleTransition(t)},l(i,[{key:"target",get:function(){return this._target||this.node},set:function(t){this._target!==t&&(this._target&&this._unregisterTargetEvent(this._target),this._target=t,this._applyTarget())}},{key:"interactable",get:function(){return this._interactable},set:function(t){this._interactable=t,this._updateState(),this._interactable||this._resetState()}},{key:"_resizeToTarget",set:function(t){t&&this._resizeNodeToTargetNode()}},{key:"transition",get:function(){return this._transition},set:function(t){this._transition!==t&&(this._transition===Ze.COLOR?this._updateColorTransition($e.NORMAL):this._transition===Ze.SPRITE&&this._updateSpriteTransition($e.NORMAL),this._transition=t,this._updateState())}},{key:"normalColor",get:function(){return this._normalColor},set:function(t){this._normalColor!==t&&(this._normalColor.set(t),this._updateState())}},{key:"pressedColor",get:function(){return this._pressedColor},set:function(t){this._pressedColor!==t&&this._pressedColor.set(t)}},{key:"hoverColor",get:function(){return this._hoverColor},set:function(t){this._hoverColor!==t&&this._hoverColor.set(t)}},{key:"disabledColor",get:function(){return this._disabledColor},set:function(t){this._disabledColor!==t&&(this._disabledColor.set(t),this._updateState())}},{key:"duration",get:function(){return this._duration},set:function(t){this._duration!==t&&(this._duration=t)}},{key:"zoomScale",get:function(){return this._zoomScale},set:function(t){this._zoomScale!==t&&(this._zoomScale=t)}},{key:"normalSprite",get:function(){return this._normalSprite},set:function(t){if(this._normalSprite!==t){this._normalSprite=t;var e=this.node.getComponent(Xt);e&&(e.spriteFrame=t),this._updateState()}}},{key:"pressedSprite",get:function(){return this._pressedSprite},set:function(t){this._pressedSprite!==t&&(this._pressedSprite=t,this._updateState())}},{key:"hoverSprite",get:function(){return this._hoverSprite},set:function(t){this._hoverSprite!==t&&(this._hoverSprite=t,this._updateState())}},{key:"disabledSprite",get:function(){return this._disabledSprite},set:function(t){this._disabledSprite!==t&&(this._disabledSprite=t,this._updateState())}}]),i}(T),Xe.Transition=Ze,Xe.EventType=qe,c((xe=Ye).prototype,"target",[oe,ne,re],Object.getOwnPropertyDescriptor(xe.prototype,"target"),xe.prototype),c(xe.prototype,"interactable",[se,ae],Object.getOwnPropertyDescriptor(xe.prototype,"interactable"),xe.prototype),c(xe.prototype,"transition",[he,le,ce],Object.getOwnPropertyDescriptor(xe.prototype,"transition"),xe.prototype),c(xe.prototype,"normalColor",[ue],Object.getOwnPropertyDescriptor(xe.prototype,"normalColor"),xe.prototype),c(xe.prototype,"pressedColor",[_e],Object.getOwnPropertyDescriptor(xe.prototype,"pressedColor"),xe.prototype),c(xe.prototype,"hoverColor",[pe],Object.getOwnPropertyDescriptor(xe.prototype,"hoverColor"),xe.prototype),c(xe.prototype,"disabledColor",[de],Object.getOwnPropertyDescriptor(xe.prototype,"disabledColor"),xe.prototype),c(xe.prototype,"duration",[fe,ge,ye],Object.getOwnPropertyDescriptor(xe.prototype,"duration"),xe.prototype),c(xe.prototype,"zoomScale",[me],Object.getOwnPropertyDescriptor(xe.prototype,"zoomScale"),xe.prototype),c(xe.prototype,"normalSprite",[Te,ve],Object.getOwnPropertyDescriptor(xe.prototype,"normalSprite"),xe.prototype),c(xe.prototype,"pressedSprite",[be,Se],Object.getOwnPropertyDescriptor(xe.prototype,"pressedSprite"),xe.prototype),c(xe.prototype,"hoverSprite",[Ce,Ee],Object.getOwnPropertyDescriptor(xe.prototype,"hoverSprite"),xe.prototype),c(xe.prototype,"disabledSprite",[Oe,we],Object.getOwnPropertyDescriptor(xe.prototype,"disabledSprite"),xe.prototype),Ie=c(xe.prototype,"clickEvents",[Le,v,Ae,De],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ze=c(xe.prototype,"_interactable",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Re=c(xe.prototype,"_transition",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Ze.NONE}}),Be=c(xe.prototype,"_normalColor",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e.WHITE.clone()}}),Me=c(xe.prototype,"_hoverColor",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new e(211,211,211,255)}}),He=c(xe.prototype,"_pressedColor",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e.WHITE.clone()}}),Ne=c(xe.prototype,"_disabledColor",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new e(124,124,124,255)}}),ke=c(xe.prototype,"_normalSprite",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Fe=c(xe.prototype,"_hoverSprite",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ve=c(xe.prototype,"_pressedSprite",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ue=c(xe.prototype,"_disabledSprite",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ge=c(xe.prototype,"_duration",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.1}}),We=c(xe.prototype,"_zoomScale",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1.2}}),je=c(xe.prototype,"_target",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Pe=xe))||Pe)||Pe)||Pe)||Pe)||Pe)||Pe)),ii=function(){function t(){}return t.add=function(t){var e=this._tabIndexList;-1===e.indexOf(t)&&e.push(t)},t.remove=function(t){var e=this._tabIndexList,i=e.indexOf(t);-1!==i&&e.splice(i,1)},t.resort=function(){this._tabIndexList.sort((function(t,e){return t._delegate.tabIndex-e._delegate.tabIndex}))},t.next=function(t){var e=this._tabIndexList,i=e.indexOf(t);if(t.setFocus(!1),-1!==i){var o=e[i+1];o&&o._delegate.tabIndex>=0&&o.setFocus(!0)}},t}();ii._tabIndexList=[],function(t){t[t.DEFAULT=0]="DEFAULT",t[t.DONE=1]="DONE",t[t.SEND=2]="SEND",t[t.SEARCH=3]="SEARCH",t[t.GO=4]="GO",t[t.NEXT=5]="NEXT"}(Qe||(Qe={})),b(Qe),function(t){t[t.ANY=0]="ANY",t[t.EMAIL_ADDR=1]="EMAIL_ADDR",t[t.NUMERIC=2]="NUMERIC",t[t.PHONE_NUMBER=3]="PHONE_NUMBER",t[t.URL=4]="URL",t[t.DECIMAL=5]="DECIMAL",t[t.SINGLE_LINE=6]="SINGLE_LINE"}(Je||(Je={})),b(Je),function(t){t[t.PASSWORD=0]="PASSWORD",t[t.SENSITIVE=1]="SENSITIVE",t[t.INITIAL_CAPS_WORD=2]="INITIAL_CAPS_WORD",t[t.INITIAL_CAPS_SENTENCE=3]="INITIAL_CAPS_SENTENCE",t[t.INITIAL_CAPS_ALL_CHARACTERS=4]="INITIAL_CAPS_ALL_CHARACTERS",t[t.DEFAULT=5]="DEFAULT"}(ti||(ti={})),b(ti);var oi,ni,ri,si,ai,hi,li,ci,ui,_i,pi,di,fi,gi,yi,mi,Ti,vi,bi,Si,Ci,Ei,Oi,wi,Li,Ai,Di,Pi,xi,Ii,zi,Ri,Bi,Mi,Hi,Ni,ki,Fi,Vi,Ui,Gi,Wi,ji,Xi,Yi,Zi,$i,qi,Ki,Qi,Ji,to,eo,io,oo,no,ro,so,ao,ho,lo,co=function(){function t(){this._editing=!1,this._delegate=null}var e=t.prototype;return e.init=function(){},e.onEnable=function(){},e.update=function(){},e.onDisable=function(){this._editing&&this.endEditing()},e.clear=function(){this._delegate=null},e.setTabIndex=function(){},e.setSize=function(){},e.setFocus=function(t){t?this.beginEditing():this.endEditing()},e.isFocused=function(){return this._editing},e.beginEditing=function(){},e.endEditing=function(){},t}(),uo=new S,_o=new S,po=new h,fo=null,go=0,yo=function(t){function e(){for(var e,i=arguments.length,o=new Array(i),n=0;n<i;n++)o[n]=arguments[n];return(e=t.call.apply(t,[this].concat(o))||this)._delegate=null,e._inputMode=-1,e._inputFlag=-1,e._returnType=-1,e.__eventListeners={},e.__fullscreen=!1,e.__autoResize=!1,e.__orientationChanged=void 0,e._edTxt=null,e._isTextArea=!1,e._textLabelFont=null,e._textLabelFontSize=null,e._textLabelFontColor=null,e._textLabelAlign=null,e._placeholderLabelFont=null,e._placeholderLabelFontSize=null,e._placeholderLabelFontColor=null,e._placeholderLabelAlign=null,e._placeholderLineHeight=null,e._placeholderStyleSheet=null,e._domId="EditBoxId_"+ ++go,e}s(e,t);var i=e.prototype;return i.init=function(t){t&&(this._delegate=t,t.inputMode===Je.ANY?this._createTextArea():this._createInput(),ii.add(this),this.setTabIndex(t.tabIndex),this._initStyleSheet(),this._registerEventListeners(),this._addDomToGameContainer(),this.__fullscreen=J.isAutoFullScreenEnabled(),this.__autoResize=J._resizeWithBrowserSize)},i.clear=function(){this._removeEventListeners(),this._removeDomFromGameContainer(),ii.remove(this),fo===this&&(fo=null),this._delegate=null},i.update=function(){this._updateMatrix()},i.setTabIndex=function(t){this._edTxt.tabIndex=t,ii.resort()},i.setSize=function(t,e){var i=this._edTxt;i&&(i.style.width=t+"px",i.style.height=e+"px")},i.beginEditing=function(){fo&&fo!==this&&fo.setFocus(!1),this._editing=!0,fo=this,this._delegate._editBoxEditingDidBegan(),this._showDom(),this._edTxt.focus()},i.endEditing=function(){this._edTxt.blur()},i._createInput=function(){this._isTextArea=!1,this._edTxt=document.createElement("input")},i._createTextArea=function(){this._isTextArea=!0,this._edTxt=document.createElement("textarea")},i._addDomToGameContainer=function(){C.GAME_VIEW&&this._edTxt?(C.gameView.container.appendChild(this._edTxt),C.gameView.head.appendChild(this._placeholderStyleSheet)):tt.container&&this._edTxt&&(tt.container.appendChild(this._edTxt),document.head.appendChild(this._placeholderStyleSheet))},i._removeDomFromGameContainer=function(){(C.GAME_VIEW?E(C.gameView.container,this._edTxt):E(tt.container,this._edTxt))&&this._edTxt&&(C.GAME_VIEW?C.gameView.container.removeChild(this._edTxt):tt.container.removeChild(this._edTxt)),(C.GAME_VIEW?E(C.gameView.head,this._placeholderStyleSheet):E(document.head,this._placeholderStyleSheet))&&(C.GAME_VIEW?C.gameView.head.removeChild(this._placeholderStyleSheet):document.head.removeChild(this._placeholderStyleSheet)),this._edTxt=null,this._placeholderStyleSheet=null},i._showDom=function(){this._updateMaxLength(),this._updateInputType(),this._updateStyleSheet(),this._edTxt&&this._delegate&&(this._edTxt.style.display="",this._delegate._hideLabels()),O.isMobile&&this._showDomOnMobile()},i._hideDom=function(){var t=this._edTxt;t&&this._delegate&&(t.style.display="none",this._delegate._showLabels()),O.isMobile&&this._hideDomOnMobile()},i._showDomOnMobile=function(){O.os===O.OS_ANDROID&&(this.__fullscreen&&(J.enableAutoFullScreen(!1),jt.exitFullScreen()),this.__autoResize&&J.resizeWithBrowserSize(!1),this._adjustWindowScroll())},i._hideDomOnMobile=function(){var t=this;O.os===O.OS_ANDROID&&(this.__autoResize&&J.resizeWithBrowserSize(!0),setTimeout((function(){fo||t.__fullscreen&&J.enableAutoFullScreen(!0)}),400)),this._scrollBackWindow()},i._adjustWindowScroll=function(){var t=this;setTimeout((function(){window.scrollY<40&&t._edTxt.scrollIntoView({block:"start",inline:"nearest",behavior:"smooth"})}),400)},i._scrollBackWindow=function(){setTimeout((function(){O.browserType!==O.BROWSER_TYPE_WECHAT||O.os!==O.OS_IOS?window.scrollTo(0,0):window.top&&window.top.scrollTo(0,0)}),400)},i._updateMatrix=function(){if(this._edTxt){var t=this._delegate.node,e=J.getScaleX(),i=J.getScaleY(),o=1,n=1;C.GAME_VIEW&&(o=C.gameView.canvas.width/C.game.canvas.width,n=C.gameView.canvas.height/C.game.canvas.height),e*=o,i*=n;var r=J.getViewportRect(),s=J.getDevicePixelRatio();t.getWorldMatrix(uo);var a=t._uiProps.uiTransformComp;if(a&&h.set(po,-a.anchorX*a.width,-a.anchorY*a.height,po.z),S.transform(uo,uo,po),!t._uiProps.uiTransformComp)return!1;var l=St.root.ui.getScreen(t._uiProps.uiTransformComp.visibility);if(C.GAME_VIEW&&(l=C.gameView.preview.canvasComp),l){l.node.getWorldRT(_o);var c=_o.m12,u=_o.m13,_=et.center;_o.m12=_.x-(_o.m00*c+_o.m04*u),_o.m13=_.y-(_o.m01*c+_o.m05*u),S.multiply(_o,_o,uo),e/=s,i/=s;var p=C.GAME_VIEW?C.gameView.container:tt.container,d=_o.m00*e,f=uo.m01,g=uo.m04,y=_o.m05*i,m=parseInt(p&&p.style.paddingLeft||"0");m+=r.x*o/s;var T=parseInt(p&&p.style.paddingBottom||"0");T+=r.y/s;var v="matrix("+d+","+-f+","+-g+","+y+","+(_o.m12*e+m)+","+-(_o.m13*i+T)+")";this._edTxt.style.transform=v,this._edTxt.style["-webkit-transform"]=v,this._edTxt.style["transform-origin"]="0px 100% 0px",this._edTxt.style["-webkit-transform-origin"]="0px 100% 0px"}}},i._updateInputType=function(){var t=this._delegate,e=t.inputMode,i=t.inputFlag,o=t.returnType,n=this._edTxt;if(this._inputMode!==e||this._inputFlag!==i||this._returnType!==o){if(this._inputMode=e,this._inputFlag=i,this._returnType=o,this._isTextArea){var r="none";return i===ti.INITIAL_CAPS_ALL_CHARACTERS?r="uppercase":i===ti.INITIAL_CAPS_WORD&&(r="capitalize"),void(n.style.textTransform=r)}if(n=n,i===ti.PASSWORD)return n.type="password",void(n.style.textTransform="none");var s=n.type;e===Je.EMAIL_ADDR?s="email":e===Je.NUMERIC||e===Je.DECIMAL?s="number":e===Je.PHONE_NUMBER?(s="number",n.pattern="[0-9]*"):e===Je.URL?s="url":(s="text",o===Qe.SEARCH&&(s="search")),n.type=s;var a="none";i===ti.INITIAL_CAPS_ALL_CHARACTERS?a="uppercase":i===ti.INITIAL_CAPS_WORD&&(a="capitalize"),n.style.textTransform=a}},i._updateMaxLength=function(){var t=this._delegate.maxLength;t<0&&(t=65535),this._edTxt.maxLength=t},i._initStyleSheet=function(){if(this._edTxt){var t=this._edTxt;t.style.color="#000000",t.style.border="0px",t.style.background="transparent",t.style.width="100%",t.style.height="100%",t.style.outline="medium",t.style.padding="0",t.style.textTransform="none",t.style.display="none",t.style.position="absolute",t.style.bottom="0px",t.style.left="2px",t.className="cocosEditBox",t.style.fontFamily="Arial",t.id=this._domId,this._isTextArea?(t.style.resize="none",t.style.overflowY="scroll"):((t=t).type="text",t.style["-moz-appearance"]="textfield"),this._placeholderStyleSheet=document.createElement("style")}},i._updateStyleSheet=function(){var t=this._delegate,e=this._edTxt;e&&t&&(e.value=t.string,e.placeholder=t.placeholder,this._updateTextLabel(t.textLabel),this._updatePlaceholderLabel(t.placeholderLabel))},i._updateTextLabel=function(t){if(t){var e=t.font;e=!e||e instanceof Ct?t.fontFamily:e._fontFamily;var i=t.fontSize*t.node.scale.y;if((this._textLabelFont!==e||this._textLabelFontSize!==i||this._textLabelFontColor!==t.fontColor||this._textLabelAlign!==t.horizontalAlign)&&(this._textLabelFont=e,this._textLabelFontSize=i,this._textLabelFontColor=t.fontColor,this._textLabelAlign=t.horizontalAlign,this._edTxt)){var o=this._edTxt;switch(o.style.fontSize=i+"px",o.style.color=t.color.toCSS(),o.style.fontFamily=e,t.horizontalAlign){case Yt.HorizontalAlign.LEFT:o.style.textAlign="left";break;case Yt.HorizontalAlign.CENTER:o.style.textAlign="center";break;case Yt.HorizontalAlign.RIGHT:o.style.textAlign="right"}}}},i._updatePlaceholderLabel=function(t){if(t){var e=t.font;e=!e||e instanceof Ct?t.fontFamily:t.font._fontFamily;var i=t.fontSize*t.node.scale.y;if(this._placeholderLabelFont!==e||this._placeholderLabelFontSize!==i||this._placeholderLabelFontColor!==t.fontColor||this._placeholderLabelAlign!==t.horizontalAlign||this._placeholderLineHeight!==t.fontSize){this._placeholderLabelFont=e,this._placeholderLabelFontSize=i,this._placeholderLabelFontColor=t.fontColor,this._placeholderLabelAlign=t.horizontalAlign,this._placeholderLineHeight=t.fontSize;var o=this._placeholderStyleSheet,n=t.color.toCSS(),r=t.fontSize,s="";switch(t.horizontalAlign){case Yt.HorizontalAlign.LEFT:s="left";break;case Yt.HorizontalAlign.CENTER:s="center";break;case Yt.HorizontalAlign.RIGHT:s="right"}o.innerHTML="#"+this._domId+"::-webkit-input-placeholder{text-transform: initial;-family: "+e+";font-size: "+i+"px;color: "+n+";line-height: "+r+"px;text-align: "+s+";}#"+this._domId+"::-moz-placeholder{text-transform: initial;-family: "+e+";font-size: "+i+"px;color: "+n+";line-height: "+r+"px;text-align: "+s+";}#"+this._domId+"::-ms-input-placeholder{text-transform: initial;-family: "+e+";font-size: "+i+"px;color: "+n+";line-height: "+r+"px;text-align: "+s+";}",C.sys.browserType===C.sys.BROWSER_TYPE_EDGE&&(o.innerHTML+="#"+this._domId+"::-ms-clear{display: none;}")}}},i._registerEventListeners=function(){if(this._edTxt){var t=this,e=this._edTxt,i=!1,o=this.__eventListeners;o.compositionStart=function(){i=!0},o.compositionEnd=function(){i=!1,t._delegate._editBoxTextChanged(e.value)},o.onInput=function(){if(!i){var o=t._delegate,n=o.maxLength;n>=0&&(e.value=e.value.slice(0,n)),o._editBoxTextChanged(e.value)}},o.onClick=function(){t._editing&&O.isMobile&&t._adjustWindowScroll()},o.onKeydown=function(i){i.keyCode===w.KEY.enter?(i.propagationStopped=!0,t._delegate._editBoxEditingReturn(),t._isTextArea||e.blur()):i.keyCode===w.KEY.tab&&(i.propagationStopped=!0,i.preventDefault(),ii.next(t))},o.onBlur=function(){O.isMobile&&i&&o.compositionEnd(),t._editing=!1,fo=null,t._hideDom(),t._delegate._editBoxEditingDidEnded()},e.addEventListener("compositionstart",o.compositionStart),e.addEventListener("compositionend",o.compositionEnd),e.addEventListener("input",o.onInput),e.addEventListener("keydown",o.onKeydown),e.addEventListener("blur",o.onBlur),e.addEventListener("touchstart",o.onClick)}},i._removeEventListeners=function(){if(this._edTxt){var t=this._edTxt,e=this.__eventListeners;t.removeEventListener("compositionstart",e.compositionStart),t.removeEventListener("compositionend",e.compositionEnd),t.removeEventListener("input",e.onInput),t.removeEventListener("keydown",e.onKeydown),t.removeEventListener("blur",e.onBlur),t.removeEventListener("touchstart",e.onClick),e.compositionStart=null,e.compositionEnd=null,e.onInput=null,e.onKeydown=null,e.onBlur=null,e.onClick=null}},e}(co);!function(t){t.EDITING_DID_BEGAN="editing-did-began",t.EDITING_DID_ENDED="editing-did-ended",t.TEXT_CHANGED="text-changed",t.EDITING_RETURN="editing-return"}(lo||(lo={}));var mo,To,vo,bo,So,Co,Eo,Oo,wo,Lo,Ao,Do,Po,xo,Io,zo,Ro,Bo,Mo,Ho,No,ko,Fo,Vo,Uo,Go,Wo,jo,Xo,Yo,Zo,$o,qo,Ko,Qo,Jo,tn,en,on,nn,rn,sn,an=t("E",(oi=o("cc.EditBox"),ni=u(),ri=q(100),si=_(),ai=K(Q),hi=p(),li=d(),ci=p(),ui=d(),_i=n(Yt),pi=p(),di=d(),fi=n(Yt),gi=p(),yi=d(),mi=n(Y),Ti=p(),vi=d(),bi=n(ti),Si=p(),Ci=d(),Ei=n(Je),Oi=p(),wi=d(),Li=n(Qe),Ai=p(),Di=d(),Pi=p(),xi=d(),Ii=p(),zi=d(),Ri=n([vt]),Bi=p(),Mi=d(),Hi=n([vt]),Ni=p(),ki=d(),Fi=n([vt]),Vi=p(),Ui=d(),Gi=n([vt]),Wi=p(),ji=d(),oi(Xi=ni(Xi=ri(Xi=si(Xi=ai(Xi=r((ho=ao=function(t){function e(){for(var e,i=arguments.length,o=new Array(i),n=0;n<i;n++)o[n]=arguments[n];return e=t.call.apply(t,[this].concat(o))||this,y(e,"editingDidBegan",Zi,m(e)),y(e,"textChanged",$i,m(e)),y(e,"editingDidEnded",qi,m(e)),y(e,"editingReturn",Ki,m(e)),e._impl=null,e._background=null,y(e,"_textLabel",Qi,m(e)),y(e,"_placeholderLabel",Ji,m(e)),y(e,"_returnType",to,m(e)),y(e,"_string",eo,m(e)),y(e,"_tabIndex",io,m(e)),y(e,"_backgroundImage",oo,m(e)),y(e,"_inputFlag",no,m(e)),y(e,"_inputMode",ro,m(e)),y(e,"_maxLength",so,m(e)),e._isLabelVisible=!1,e}s(e,t);var i=e.prototype;return i.__preload=function(){this._init()},i.onEnable=function(){this._registerEvent(),this._impl&&this._impl.onEnable()},i.update=function(){this._impl&&this._impl.update()},i.onDisable=function(){this._unregisterEvent(),this._impl&&this._impl.onDisable()},i.onDestroy=function(){this._impl&&this._impl.clear()},i.setFocus=function(){this._impl&&this._impl.setFocus(!0)},i.focus=function(){this._impl&&this._impl.setFocus(!0)},i.blur=function(){this._impl&&this._impl.setFocus(!1)},i.isFocused=function(){return!!this._impl&&this._impl.isFocused()},i._editBoxEditingDidBegan=function(){vt.emitEvents(this.editingDidBegan,this),this.node.emit(lo.EDITING_DID_BEGAN,this)},i._editBoxEditingDidEnded=function(){vt.emitEvents(this.editingDidEnded,this),this.node.emit(lo.EDITING_DID_ENDED,this)},i._editBoxTextChanged=function(t){t=this._updateLabelStringStyle(t,!0),this.string=t,vt.emitEvents(this.textChanged,t,this),this.node.emit(lo.TEXT_CHANGED,this)},i._editBoxEditingReturn=function(){vt.emitEvents(this.editingReturn,this),this.node.emit(lo.EDITING_RETURN,this)},i._showLabels=function(){this._isLabelVisible=!0,this._updateLabels()},i._hideLabels=function(){this._isLabelVisible=!1,this._textLabel&&(this._textLabel.node.active=!1),this._placeholderLabel&&(this._placeholderLabel.node.active=!1)},i._onTouchBegan=function(t){t.propagationStopped=!0},i._onTouchCancel=function(t){t.propagationStopped=!0},i._onTouchEnded=function(t){this._impl&&this._impl.beginEditing(),t.propagationStopped=!0},i._init=function(){this._createBackgroundSprite(),this._updatePlaceholderLabel(),this._updateTextLabel(),this._isLabelVisible=!0,this.node.on(Z.SIZE_CHANGED,this._resizeChildNodes,this),(this._impl=new e._EditBoxImpl).init(this),this._updateString(this._string),this._syncSize()},i._createBackgroundSprite=function(){this._background||(this._background=this.node.getComponent(Xt),this._background||(this._background=this.node.addComponent(Xt))),this._background.type=Xt.Type.SLICED,this._background.spriteFrame=this._backgroundImage},i._updateTextLabel=function(){var t=this._textLabel;if(!t){var e=this.node.getChildByName("TEXT_LABEL");e||(e=new X("TEXT_LABEL")),(t=e.getComponent(Yt))||(t=e.addComponent(Yt)),e.parent=this.node,this._textLabel=t}this._textLabel.node._uiProps.uiTransformComp.setAnchorPoint(0,1),t.overflow=Yt.Overflow.CLAMP,this._inputMode===Je.ANY?(t.verticalAlign=Zt.TOP,t.enableWrapText=!0):(t.verticalAlign=Zt.CENTER,t.enableWrapText=!1),t.string=this._updateLabelStringStyle(this._string)},i._updatePlaceholderLabel=function(){var t=this._placeholderLabel;if(!t){var e=this.node.getChildByName("PLACEHOLDER_LABEL");e||(e=new X("PLACEHOLDER_LABEL")),(t=e.getComponent(Yt))||(t=e.addComponent(Yt)),e.parent=this.node,this._placeholderLabel=t}this._placeholderLabel.node._uiProps.uiTransformComp.setAnchorPoint(0,1),t.overflow=Yt.Overflow.CLAMP,this._inputMode===Je.ANY?(t.verticalAlign=Zt.TOP,t.enableWrapText=!0):(t.verticalAlign=Zt.CENTER,t.enableWrapText=!1),t.string=this.placeholder},i._syncSize=function(){var t=this.node._uiProps.uiTransformComp,e=t.contentSize;if(this._background){var i=this._background.node._uiProps.uiTransformComp;i.anchorPoint=t.anchorPoint,i.setContentSize(e)}this._updateLabelPosition(e),this._impl&&this._impl.setSize(e.width,e.height)},i._updateLabels=function(){if(this._isLabelVisible){var t=this._string;this._textLabel&&(this._textLabel.node.active=""!==t),this._placeholderLabel&&(this._placeholderLabel.node.active=""===t)}},i._updateString=function(t){var e=this._textLabel;if(e){var i=t;i&&(i=this._updateLabelStringStyle(i)),e.string=i,this._updateLabels()}},i._updateLabelStringStyle=function(t,e){void 0===e&&(e=!1);var i=this._inputFlag;if(e||i!==ti.PASSWORD)i===ti.INITIAL_CAPS_ALL_CHARACTERS?t=t.toUpperCase():i===ti.INITIAL_CAPS_WORD?t=t.replace(/(?:^|\s)\S/g,(function(t){return t.toUpperCase()})):i===ti.INITIAL_CAPS_SENTENCE&&(t=function(t){return t.charAt(0).toUpperCase()+t.slice(1)}(t));else{for(var o="",n=t.length,r=0;r<n;++r)o+="●";t=o}return t},i._registerEvent=function(){this.node.on(Z.TOUCH_START,this._onTouchBegan,this),this.node.on(Z.TOUCH_END,this._onTouchEnded,this)},i._unregisterEvent=function(){this.node.off(Z.TOUCH_START,this._onTouchBegan,this),this.node.off(Z.TOUCH_END,this._onTouchEnded,this)},i._updateLabelPosition=function(t){var e=this.node._uiProps.uiTransformComp,i=-e.anchorX*e.width,o=-e.anchorY*e.height,n=this._placeholderLabel,r=this._textLabel;r&&(r.node._uiProps.uiTransformComp.setContentSize(t.width-2,t.height),r.node.position=new h(i+2,o+t.height,r.node.position.z),r.verticalAlign=this._inputMode===Je.ANY?Zt.TOP:Zt.CENTER,r.enableWrapText=this._inputMode===Je.ANY),n&&(n.node._uiProps.uiTransformComp.setContentSize(t.width-2,t.height),n.lineHeight=t.height,n.node.position=new h(i+2,o+t.height,n.node.position.z),n.verticalAlign=this._inputMode===Je.ANY?Zt.TOP:Zt.CENTER,n.enableWrapText=this._inputMode===Je.ANY)},i._resizeChildNodes=function(){var t=this.node._uiProps.uiTransformComp,e=this._textLabel&&this._textLabel.node;e&&(e.position=new h(-t.width/2,t.height/2,e.position.z),e._uiProps.uiTransformComp.setContentSize(t.contentSize));var i=this._placeholderLabel&&this._placeholderLabel.node;i&&(i.position=new h(-t.width/2,t.height/2,i.position.z),i._uiProps.uiTransformComp.setContentSize(t.contentSize));var o=this._background&&this._background.node;o&&o._uiProps.uiTransformComp.setContentSize(t.contentSize)},l(e,[{key:"string",get:function(){return this._string},set:function(t){this._maxLength>=0&&t.length>=this._maxLength&&(t=t.slice(0,this._maxLength)),this._string=t,this._updateString(t)}},{key:"placeholder",get:function(){return this._placeholderLabel?this._placeholderLabel.string:""},set:function(t){this._placeholderLabel&&(this._placeholderLabel.string=t)}},{key:"textLabel",get:function(){return this._textLabel},set:function(t){this._textLabel!==t&&(this._textLabel=t,this._textLabel&&(this._updateTextLabel(),this._updateLabels()))}},{key:"placeholderLabel",get:function(){return this._placeholderLabel},set:function(t){this._placeholderLabel!==t&&(this._placeholderLabel=t,this._placeholderLabel&&(this._updatePlaceholderLabel(),this._updateLabels()))}},{key:"backgroundImage",get:function(){return this._backgroundImage},set:function(t){this._backgroundImage!==t&&(this._backgroundImage=t,this._createBackgroundSprite())}},{key:"inputFlag",get:function(){return this._inputFlag},set:function(t){this._inputFlag=t,this._updateString(this._string)}},{key:"inputMode",get:function(){return this._inputMode},set:function(t){this._inputMode!==t&&(this._inputMode=t,this._updateTextLabel(),this._updatePlaceholderLabel())}},{key:"returnType",get:function(){return this._returnType},set:function(t){this._returnType=t}},{key:"maxLength",get:function(){return this._maxLength},set:function(t){this._maxLength=t}},{key:"tabIndex",get:function(){return this._tabIndex},set:function(t){this._tabIndex!==t&&(this._tabIndex=t,this._impl&&this._impl.setTabIndex(t))}}]),e}(T),ao._EditBoxImpl=co,ao.KeyboardReturnType=Qe,ao.InputFlag=ti,ao.InputMode=Je,ao.EventType=lo,c((Yi=ho).prototype,"string",[hi,li],Object.getOwnPropertyDescriptor(Yi.prototype,"string"),Yi.prototype),c(Yi.prototype,"placeholder",[ci,ui],Object.getOwnPropertyDescriptor(Yi.prototype,"placeholder"),Yi.prototype),c(Yi.prototype,"textLabel",[_i,pi,di],Object.getOwnPropertyDescriptor(Yi.prototype,"textLabel"),Yi.prototype),c(Yi.prototype,"placeholderLabel",[fi,gi,yi],Object.getOwnPropertyDescriptor(Yi.prototype,"placeholderLabel"),Yi.prototype),c(Yi.prototype,"backgroundImage",[mi,Ti,vi],Object.getOwnPropertyDescriptor(Yi.prototype,"backgroundImage"),Yi.prototype),c(Yi.prototype,"inputFlag",[bi,Si,Ci],Object.getOwnPropertyDescriptor(Yi.prototype,"inputFlag"),Yi.prototype),c(Yi.prototype,"inputMode",[Ei,Oi,wi],Object.getOwnPropertyDescriptor(Yi.prototype,"inputMode"),Yi.prototype),c(Yi.prototype,"returnType",[Li,Ai,Di],Object.getOwnPropertyDescriptor(Yi.prototype,"returnType"),Yi.prototype),c(Yi.prototype,"maxLength",[Pi,xi],Object.getOwnPropertyDescriptor(Yi.prototype,"maxLength"),Yi.prototype),c(Yi.prototype,"tabIndex",[Ii,zi],Object.getOwnPropertyDescriptor(Yi.prototype,"tabIndex"),Yi.prototype),Zi=c(Yi.prototype,"editingDidBegan",[Ri,v,Bi,Mi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),$i=c(Yi.prototype,"textChanged",[Hi,v,Ni,ki],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),qi=c(Yi.prototype,"editingDidEnded",[Fi,v,Vi,Ui],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ki=c(Yi.prototype,"editingReturn",[Gi,v,Wi,ji],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Qi=c(Yi.prototype,"_textLabel",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ji=c(Yi.prototype,"_placeholderLabel",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),to=c(Yi.prototype,"_returnType",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Qe.DEFAULT}}),eo=c(Yi.prototype,"_string",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),io=c(Yi.prototype,"_tabIndex",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),oo=c(Yi.prototype,"_backgroundImage",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),no=c(Yi.prototype,"_inputFlag",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return ti.DEFAULT}}),ro=c(Yi.prototype,"_inputMode",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Je.ANY}}),so=c(Yi.prototype,"_maxLength",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 20}}),Xi=Yi))||Xi)||Xi)||Xi)||Xi)||Xi)||Xi));O.isBrowser&&(an._EditBoxImpl=yo);var hn,ln,cn,un,_n,pn=Z;!function(t){t[t.NONE=0]="NONE",t[t.HORIZONTAL=1]="HORIZONTAL",t[t.VERTICAL=2]="VERTICAL",t[t.GRID=3]="GRID"}(hn||(hn={})),i(hn),function(t){t[t.NONE=0]="NONE",t[t.CONTAINER=1]="CONTAINER",t[t.CHILDREN=2]="CHILDREN"}(ln||(ln={})),i(ln),function(t){t[t.HORIZONTAL=0]="HORIZONTAL",t[t.VERTICAL=1]="VERTICAL"}(cn||(cn={})),i(cn),function(t){t[t.BOTTOM_TO_TOP=0]="BOTTOM_TO_TOP",t[t.TOP_TO_BOTTOM=1]="TOP_TO_BOTTOM"}(un||(un={})),i(un),function(t){t[t.LEFT_TO_RIGHT=0]="LEFT_TO_RIGHT",t[t.RIGHT_TO_LEFT=1]="RIGHT_TO_LEFT"}(_n||(_n={})),i(_n);var dn,fn,gn,yn,mn,Tn,vn,bn,Sn,Cn,En,On,wn,Ln,An,Dn,Pn,xn,In,zn,Rn,Bn,Mn,Hn,Nn,kn,Fn,Vn,Un=new h,Gn=new h,Wn=t("c",(mo=o("cc.Layout"),To=u(),vo=q(110),bo=_(),So=K(Q),Co=n(hn),Eo=d(),Oo=n(ln),wo=d(),Lo=d(),Ao=n(cn),Do=d(),Po=d(),xo=d(),Io=d(),zo=d(),Ro=d(),Bo=d(),Mo=n(un),Ho=d(),No=n(_n),ko=d(),Fo=d(),Vo=d(),mo(Uo=To(Uo=vo(Uo=bo(Uo=So(Uo=r((sn=rn=function(t){function e(){for(var e,i=arguments.length,o=new Array(i),n=0;n<i;n++)o[n]=arguments[n];return e=t.call.apply(t,[this].concat(o))||this,y(e,"_resizeMode",Wo,m(e)),y(e,"_N$layoutType",jo,m(e)),y(e,"_N$padding",Xo,m(e)),y(e,"_cellSize",Yo,m(e)),y(e,"_startAxis",Zo,m(e)),y(e,"_paddingLeft",$o,m(e)),y(e,"_paddingRight",qo,m(e)),y(e,"_paddingTop",Ko,m(e)),y(e,"_paddingBottom",Qo,m(e)),y(e,"_spacingX",Jo,m(e)),y(e,"_spacingY",tn,m(e)),y(e,"_verticalDirection",en,m(e)),y(e,"_horizontalDirection",on,m(e)),y(e,"_affectedByScale",nn,m(e)),e._layoutSize=new L(300,200),e._layoutDirty=!0,e._isAlign=!1,e}s(e,t);var i=e.prototype;return i.updateLayout=function(){this._layoutDirty&&this.node.children.length>0&&(this._doLayout(),this._layoutDirty=!1)},i.onEnable=function(){this._addEventListeners();var t=this.node._uiProps.uiTransformComp;t.contentSize.equals(L.ZERO)&&t.setContentSize(this._layoutSize),0!==this._N$padding&&this._migratePaddingData(),this._doLayoutDirty()},i.onDisable=function(){this._removeEventListeners()},i._migratePaddingData=function(){this._paddingLeft=this._N$padding,this._paddingRight=this._N$padding,this._paddingTop=this._N$padding,this._paddingBottom=this._N$padding,this._N$padding=0},i._addEventListeners=function(){St.on(Et.EVENT_AFTER_UPDATE,this.updateLayout,this),this.node.on(pn.SIZE_CHANGED,this._resized,this),this.node.on(pn.ANCHOR_CHANGED,this._doLayoutDirty,this),this.node.on(pn.CHILD_ADDED,this._childAdded,this),this.node.on(pn.CHILD_REMOVED,this._childRemoved,this),this._addChildrenEventListeners()},i._removeEventListeners=function(){St.off(Et.EVENT_AFTER_UPDATE,this.updateLayout,this),this.node.off(pn.SIZE_CHANGED,this._resized,this),this.node.off(pn.ANCHOR_CHANGED,this._doLayoutDirty,this),this.node.off(pn.CHILD_ADDED,this._childAdded,this),this.node.off(pn.CHILD_REMOVED,this._childRemoved,this),this._removeChildrenEventListeners()},i._addChildrenEventListeners=function(){for(var t=this.node.children,e=0;e<t.length;++e){var i=t[e];i.on(pn.TRANSFORM_CHANGED,this._doScaleDirty,this),i.on(pn.SIZE_CHANGED,this._doLayoutDirty,this),i.on(pn.TRANSFORM_CHANGED,this._transformDirty,this),i.on(pn.ANCHOR_CHANGED,this._doLayoutDirty,this),i.on("active-in-hierarchy-changed",this._doLayoutDirty,this)}},i._removeChildrenEventListeners=function(){for(var t=this.node.children,e=0;e<t.length;++e){var i=t[e];i.off(pn.TRANSFORM_CHANGED,this._doScaleDirty,this),i.off(pn.SIZE_CHANGED,this._doLayoutDirty,this),i.off(pn.TRANSFORM_CHANGED,this._transformDirty,this),i.off(pn.ANCHOR_CHANGED,this._doLayoutDirty,this),i.off("active-in-hierarchy-changed",this._doLayoutDirty,this)}},i._childAdded=function(t){t.on(pn.TRANSFORM_CHANGED,this._doScaleDirty,this),t.on(pn.SIZE_CHANGED,this._doLayoutDirty,this),t.on(pn.TRANSFORM_CHANGED,this._transformDirty,this),t.on(pn.ANCHOR_CHANGED,this._doLayoutDirty,this),t.on("active-in-hierarchy-changed",this._doLayoutDirty,this),this._doLayoutDirty()},i._childRemoved=function(t){t.off(pn.TRANSFORM_CHANGED,this._doScaleDirty,this),t.off(pn.SIZE_CHANGED,this._doLayoutDirty,this),t.off(pn.TRANSFORM_CHANGED,this._transformDirty,this),t.off(pn.ANCHOR_CHANGED,this._doLayoutDirty,this),t.off("active-in-hierarchy-changed",this._doLayoutDirty,this),this._doLayoutDirty()},i._resized=function(){this._layoutSize.set(this.node._uiProps.uiTransformComp.contentSize),this._doLayoutDirty()},i._doLayoutHorizontally=function(t,e,i,o){var n=this.node._uiProps.uiTransformComp,r=n.anchorPoint,s=this.node.children,a=1,h=this._paddingLeft,l=-r.x*t;this._horizontalDirection===_n.RIGHT_TO_LEFT&&(a=-1,l=(1-r.x)*t,h=this._paddingRight);for(var c=l+a*h-a*this._spacingX,u=0,_=0,p=0,d=0,f=0,g=0,y=0,m=0;m<s.length;++m)s[m].activeInHierarchy&&y++;var T=this._cellSize.width;this._N$layoutType!==hn.GRID&&this._resizeMode===ln.CHILDREN&&(T=(t-(this._paddingLeft+this._paddingRight)-(y-1)*this._spacingX)/y);for(var v=0;v<s.length;++v){var b=s[v],S=b._uiProps.uiTransformComp;if(b.activeInHierarchy&&S){b.getScale(Gn);var C=this._getUsedScaleValue(Gn.x),E=this._getUsedScaleValue(Gn.y);this._resizeMode===ln.CHILDREN&&(S.width=T/C,this._N$layoutType===hn.GRID&&(S.height=this._cellSize.height/E));var O=S.anchorX,w=S.width*C,L=S.height*E;p>_&&(_=p),L>=_&&(p=_,_=L,g=S.anchorY),this._horizontalDirection===_n.RIGHT_TO_LEFT&&(O=1-S.anchorX),c=c+a*O*w+a*this._spacingX;var A=a*(1-O)*w;if(e){var D=c+A+a*(a>0?this._paddingRight:this._paddingLeft),P=!1;this._horizontalDirection===_n.LEFT_TO_RIGHT&&D>(1-r.x)*t&&(P=!0);var x=!1;this._horizontalDirection===_n.RIGHT_TO_LEFT&&D<-r.x*t&&(x=!0),(P||x)&&(L>=_?(0===p&&(p=_),u+=p,p=_):(u+=_,p=L,_=0),c=l+a*(h+O*w),d++)}var I=i(b,S,u,d);t>=w+this._paddingLeft+this._paddingRight&&o&&(b.getPosition(Un),b.setPosition(c,I,Un.z));var z=1,R=void 0,B=0===_?L:_;this._verticalDirection===un.TOP_TO_BOTTOM?(f=f||n.height,(R=I+(z=-1)*(B*g+this._paddingBottom))<f&&(f=R)):(f=f||-n.height,(R=I+z*(B*g+this._paddingTop))>f&&(f=R)),c+=A}}return f},i._doLayoutVertically=function(t,e,i,o){var n=this.node._uiProps.uiTransformComp,r=n.anchorPoint,s=this.node.children,a=1,h=this._paddingBottom,l=-r.y*t;this._verticalDirection===un.TOP_TO_BOTTOM&&(a=-1,l=(1-r.y)*t,h=this._paddingTop);for(var c=l+a*h-a*this._spacingY,u=0,_=0,p=0,d=0,f=0,g=0,y=0,m=0;m<s.length;++m)s[m].activeInHierarchy&&y++;var T=this._cellSize.height;this._N$layoutType!==hn.GRID&&this._resizeMode===ln.CHILDREN&&(T=(t-(this._paddingTop+this._paddingBottom)-(y-1)*this._spacingY)/y);for(var v=0;v<s.length;++v){var b=s[v];if(b){var S=b.getScale(),C=this._getUsedScaleValue(S.x),E=this._getUsedScaleValue(S.y),O=b._uiProps.uiTransformComp;if(b.activeInHierarchy&&O){this._resizeMode===ln.CHILDREN&&(O.height=T/E,this._N$layoutType===hn.GRID&&(O.width=this._cellSize.width/C));var w=O.anchorY,L=O.width*C,A=O.height*E;p>_&&(_=p),L>=_&&(p=_,_=L,g=O.anchorX),this._verticalDirection===un.TOP_TO_BOTTOM&&(w=1-O.anchorY),c=c+a*w*A+a*this._spacingY;var D=a*(1-w)*A;if(e){var P=c+D+a*(a>0?this._paddingTop:this._paddingBottom),x=!1;this._verticalDirection===un.BOTTOM_TO_TOP&&P>(1-r.y)*t&&(x=!0);var I=!1;this._verticalDirection===un.TOP_TO_BOTTOM&&P<-r.y*t&&(I=!0),(x||I)&&(L>=_?(0===p&&(p=_),u+=p,p=_):(u+=_,p=L,_=0),c=l+a*(h+w*A),d++)}var z=i(b,O,u,d);t>=A+(this._paddingTop+this._paddingBottom)&&o&&(b.getPosition(Un),b.setPosition(z,c,Un.z));var R=1,B=void 0,M=0===_?L:_;this._horizontalDirection===_n.RIGHT_TO_LEFT?(R=-1,f=f||n.width,(B=z+R*(M*g+this._paddingLeft))<f&&(f=B)):(f=f||-n.width,(B=z+R*(M*g+this._paddingRight))>f&&(f=B)),c+=D}}}return f},i._doLayoutBasic=function(){for(var t=this.node.children,e=null,i=0;i<t.length;++i){var o=t[i],n=o._uiProps.uiTransformComp;n&&o.activeInHierarchy&&(e?A.union(e,e,n.getBoundingBoxToWorld()):e=n.getBoundingBoxToWorld())}if(e){var r=this.node.parent.getComponent(Q);if(!r)return;h.set(Un,e.x,e.y,0);var s=new h;r.convertToNodeSpaceAR(Un,s),h.set(s,s.x-this._paddingLeft,s.y-this._paddingBottom,s.z),h.set(Un,e.x+e.width,e.y+e.height,0);var a=new h;r.convertToNodeSpaceAR(Un,a),h.set(a,a.x+this._paddingRight,a.y+this._paddingTop,a.z);var l=C.size(parseFloat((a.x-s.x).toFixed(2)),parseFloat((a.y-s.y).toFixed(2)));this.node.getPosition(Un);var c=this.node._uiProps.uiTransformComp;if(0!==l.width){var u=(Un.x-s.x)/l.width;c.anchorX=parseFloat(u.toFixed(2))}if(0!==l.height){var _=(Un.y-s.y)/l.height;c.anchorY=parseFloat(_.toFixed(2))}c.setContentSize(l)}},i._doLayoutGridAxisHorizontal=function(t,e){var i=this,o=e.width,n=1,r=-t.y*e.height,s=this._paddingBottom;this._verticalDirection===un.TOP_TO_BOTTOM&&(n=-1,r=(1-t.y)*e.height,s=this._paddingTop);var a=this,h=function(t,e,o,h){return r+n*(o+e.anchorY*e.height*a._getUsedScaleValue(t.getScale().y)+s+h*i._spacingY)},l=0;if(this._resizeMode===ln.CONTAINER){var c=this._doLayoutHorizontally(o,!0,h,!1);(l=r-c)<0&&(l*=-1),r=-t.y*l,this._verticalDirection===un.TOP_TO_BOTTOM&&(n=-1,r=(1-t.y)*l)}this._doLayoutHorizontally(o,!0,h,!0),this._resizeMode===ln.CONTAINER&&this.node._uiProps.uiTransformComp.setContentSize(o,l)},i._doLayoutGridAxisVertical=function(t,e){var i=this,o=e.height,n=1,r=-t.x*e.width,s=this._paddingLeft;this._horizontalDirection===_n.RIGHT_TO_LEFT&&(n=-1,r=(1-t.x)*e.width,s=this._paddingRight);var a=this,h=function(t,e,o,h){return r+n*(o+e.anchorX*e.width*a._getUsedScaleValue(t.getScale().x)+s+h*i._spacingX)},l=0;if(this._resizeMode===ln.CONTAINER){var c=this._doLayoutVertically(o,!0,h,!1);(l=r-c)<0&&(l*=-1),r=-t.x*l,this._horizontalDirection===_n.RIGHT_TO_LEFT&&(n=-1,r=(1-t.x)*l)}this._doLayoutVertically(o,!0,h,!0),this._resizeMode===ln.CONTAINER&&this.node._uiProps.uiTransformComp.setContentSize(l,o)},i._doLayoutGrid=function(){var t=this.node._uiProps.uiTransformComp,e=t.anchorPoint,i=t.contentSize;this.startAxis===cn.HORIZONTAL?this._doLayoutGridAxisHorizontal(e,i):this.startAxis===cn.VERTICAL&&this._doLayoutGridAxisVertical(e,i)},i._getHorizontalBaseWidth=function(t){var e=0,i=0;if(this._resizeMode===ln.CONTAINER){for(var o=0;o<t.length;++o){var n=t[o];n.getScale(Gn);var r=n._uiProps.uiTransformComp;n.activeInHierarchy&&r&&(i++,e+=r.width*this._getUsedScaleValue(Gn.x))}e+=(i-1)*this._spacingX+this._paddingLeft+this._paddingRight}else e=this.node._uiProps.uiTransformComp.width;return e},i._getVerticalBaseHeight=function(t){var e=0,i=0;if(this._resizeMode===ln.CONTAINER){for(var o=0;o<t.length;++o){var n=t[o];n.getScale(Gn);var r=n._uiProps.uiTransformComp;n.activeInHierarchy&&r&&(i++,e+=r.height*this._getUsedScaleValue(Gn.y))}e+=(i-1)*this._spacingY+this._paddingBottom+this._paddingTop}else e=this.node._uiProps.uiTransformComp.height;return e},i._doLayout=function(){var t=this;if(this._N$layoutType===hn.HORIZONTAL){var e=this._getHorizontalBaseWidth(this.node.children);this._doLayoutHorizontally(e,!1,(function(e){return(t._isAlign?h.ZERO:e.position).y}),!0),this._isAlign=!1,this.node._uiProps.uiTransformComp.width=e}else if(this._N$layoutType===hn.VERTICAL){var i=this._getVerticalBaseHeight(this.node.children);this._doLayoutVertically(i,!1,(function(e){return(t._isAlign?h.ZERO:e.position).x}),!0),this._isAlign=!1,this.node._uiProps.uiTransformComp.height=i}else this._N$layoutType===hn.NONE?this._resizeMode===ln.CONTAINER&&this._doLayoutBasic():this._N$layoutType===hn.GRID&&this._doLayoutGrid()},i._getUsedScaleValue=function(t){return this._affectedByScale?Math.abs(t):1},i._transformDirty=function(t){t&$.POSITION&&this._doLayoutDirty()},i._doLayoutDirty=function(){this._layoutDirty=!0},i._doScaleDirty=function(t){t&$.SCALE&&(this._layoutDirty=this._layoutDirty||this._affectedByScale)},l(e,[{key:"type",get:function(){return this._N$layoutType},set:function(t){this._N$layoutType=t,this._isAlign=!0,this._doLayoutDirty()}},{key:"resizeMode",get:function(){return this._resizeMode},set:function(t){this._N$layoutType===hn.NONE&&t===ln.CHILDREN||(this._resizeMode=t,this._doLayoutDirty())}},{key:"cellSize",get:function(){return this._cellSize},set:function(t){this._cellSize!==t&&(this._cellSize.set(t),this._doLayoutDirty())}},{key:"startAxis",get:function(){return this._startAxis},set:function(t){this._startAxis!==t&&(this._startAxis=t,this._doLayoutDirty())}},{key:"paddingLeft",get:function(){return this._paddingLeft},set:function(t){this._paddingLeft!==t&&(this._paddingLeft=t,this._doLayoutDirty())}},{key:"paddingRight",get:function(){return this._paddingRight},set:function(t){this._paddingRight!==t&&(this._paddingRight=t,this._doLayoutDirty())}},{key:"paddingTop",get:function(){return this._paddingTop},set:function(t){this._paddingTop!==t&&(this._paddingTop=t,this._doLayoutDirty())}},{key:"paddingBottom",get:function(){return this._paddingBottom},set:function(t){this._paddingBottom!==t&&(this._paddingBottom=t,this._doLayoutDirty())}},{key:"spacingX",get:function(){return this._spacingX},set:function(t){this._spacingX!==t&&(this._spacingX=t,this._doLayoutDirty())}},{key:"spacingY",get:function(){return this._spacingY},set:function(t){this._spacingY!==t&&(this._spacingY=t,this._doLayoutDirty())}},{key:"verticalDirection",get:function(){return this._verticalDirection},set:function(t){this._verticalDirection!==t&&(this._verticalDirection=t,this._doLayoutDirty())}},{key:"horizontalDirection",get:function(){return this._horizontalDirection},set:function(t){this._horizontalDirection!==t&&(this._horizontalDirection=t,this._doLayoutDirty())}},{key:"padding",get:function(){return this._paddingLeft},set:function(t){this._N$padding=t,this._migratePaddingData(),this._doLayoutDirty()}},{key:"affectedByScale",get:function(){return this._affectedByScale},set:function(t){this._affectedByScale=t,this._doLayoutDirty()}}]),e}(T),rn.Type=hn,rn.VerticalDirection=un,rn.HorizontalDirection=_n,rn.ResizeMode=ln,rn.AxisDirection=cn,c((Go=sn).prototype,"type",[Co,Eo],Object.getOwnPropertyDescriptor(Go.prototype,"type"),Go.prototype),c(Go.prototype,"resizeMode",[Oo,wo],Object.getOwnPropertyDescriptor(Go.prototype,"resizeMode"),Go.prototype),c(Go.prototype,"cellSize",[Lo],Object.getOwnPropertyDescriptor(Go.prototype,"cellSize"),Go.prototype),c(Go.prototype,"startAxis",[Ao,Do],Object.getOwnPropertyDescriptor(Go.prototype,"startAxis"),Go.prototype),c(Go.prototype,"paddingLeft",[Po],Object.getOwnPropertyDescriptor(Go.prototype,"paddingLeft"),Go.prototype),c(Go.prototype,"paddingRight",[xo],Object.getOwnPropertyDescriptor(Go.prototype,"paddingRight"),Go.prototype),c(Go.prototype,"paddingTop",[Io],Object.getOwnPropertyDescriptor(Go.prototype,"paddingTop"),Go.prototype),c(Go.prototype,"paddingBottom",[zo],Object.getOwnPropertyDescriptor(Go.prototype,"paddingBottom"),Go.prototype),c(Go.prototype,"spacingX",[Ro],Object.getOwnPropertyDescriptor(Go.prototype,"spacingX"),Go.prototype),c(Go.prototype,"spacingY",[Bo],Object.getOwnPropertyDescriptor(Go.prototype,"spacingY"),Go.prototype),c(Go.prototype,"verticalDirection",[Mo,Ho],Object.getOwnPropertyDescriptor(Go.prototype,"verticalDirection"),Go.prototype),c(Go.prototype,"horizontalDirection",[No,ko],Object.getOwnPropertyDescriptor(Go.prototype,"horizontalDirection"),Go.prototype),c(Go.prototype,"padding",[Fo],Object.getOwnPropertyDescriptor(Go.prototype,"padding"),Go.prototype),c(Go.prototype,"affectedByScale",[Vo],Object.getOwnPropertyDescriptor(Go.prototype,"affectedByScale"),Go.prototype),Wo=c(Go.prototype,"_resizeMode",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return ln.NONE}}),jo=c(Go.prototype,"_N$layoutType",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return hn.NONE}}),Xo=c(Go.prototype,"_N$padding",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Yo=c(Go.prototype,"_cellSize",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new L(40,40)}}),Zo=c(Go.prototype,"_startAxis",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return cn.HORIZONTAL}}),$o=c(Go.prototype,"_paddingLeft",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),qo=c(Go.prototype,"_paddingRight",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Ko=c(Go.prototype,"_paddingTop",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Qo=c(Go.prototype,"_paddingBottom",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Jo=c(Go.prototype,"_spacingX",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),tn=c(Go.prototype,"_spacingY",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),en=c(Go.prototype,"_verticalDirection",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return un.TOP_TO_BOTTOM}}),on=c(Go.prototype,"_horizontalDirection",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return _n.LEFT_TO_RIGHT}}),nn=c(Go.prototype,"_affectedByScale",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Uo=Go))||Uo)||Uo)||Uo)||Uo)||Uo)||Uo)),jn=new S,Xn=new D,Yn=new S,Zn=[];!function(t){t[t.RECT=0]="RECT",t[t.ELLIPSE=1]="ELLIPSE",t[t.GRAPHICS_STENCIL=2]="GRAPHICS_STENCIL",t[t.IMAGE_STENCIL=3]="IMAGE_STENCIL"}(Vn||(Vn=t("b",{}))),i(Vn);var $n,qn,Kn,Qn,Jn,tr,er,ir,or,nr,rr,sr,ar,hr,lr,cr,ur,_r,pr,dr,fr,gr,yr,mr=t("M",(dn=o("cc.Mask"),fn=u(),gn=q(110),yn=_(),mn=n(Vn),Tn=p(),vn=d(),bn=p(),Sn=d(),Cn=I(),En=n(Y),On=I(),wn=I(),Ln=z(),An=I(),Dn=I(),Pn=I(),xn=I(),dn(In=fn(In=gn(In=yn((Fn=kn=function(t){function i(){var e;return(e=t.call(this)||this)._clearStencilMtl=null,e._clearModel=null,y(e,"_type",Rn,m(e)),y(e,"_inverted",Bn,m(e)),y(e,"_segments",Mn,m(e)),y(e,"_spriteFrame",Hn,m(e)),y(e,"_alphaThreshold",Nn,m(e)),e._graphics=null,e._instanceMaterialType=Ot.ADD_COLOR,e}s(i,t),l(i,[{key:"type",get:function(){return this._type},set:function(t){this._type!==t&&(this._type!==Vn.IMAGE_STENCIL||this._spriteFrame||this._attachClearModel(),this._type=t,this.markForUpdateRenderData(!1),this._updateMaterial(),this._type!==Vn.IMAGE_STENCIL?(this._spriteFrame=null,this._updateGraphics(),this._renderData&&(this.destroyRenderData(),this._renderData=null)):(this._useRenderData(),this._spriteFrame||this._detachClearModel(),this._graphics&&this._graphics.clear()))}},{key:"inverted",get:function(){return this._inverted},set:function(t){C.game.renderType!==ct.RENDER_TYPE_CANVAS?(this._inverted=t,this.stencilStage=At.DISABLED,this._graphics&&(this._graphics.stencilStage=At.DISABLED)):R(4202)}},{key:"segments",get:function(){return this._segments},set:function(t){this._segments!==t&&(this._segments=B(t,3,1e4),this._updateGraphics())}},{key:"spriteFrame",get:function(){return this._spriteFrame},set:function(t){if(this._spriteFrame!==t){var e=this._spriteFrame;this._spriteFrame=t,this._type===Vn.IMAGE_STENCIL&&(!e&&t?(this._attachClearModel(),this.markForUpdateRenderData()):t||this._detachClearModel())}}},{key:"alphaThreshold",get:function(){return this._alphaThreshold},set:function(t){var e,i;this._alphaThreshold!==t&&(this._alphaThreshold=t,this.type===Vn.IMAGE_STENCIL&&(null===(e=this._graphics)||void 0===e||null===(i=e.getMaterialInstance(0))||void 0===i||i.setProperty("alphaThreshold",this._alphaThreshold)))}},{key:"graphics",get:function(){return this._graphics}},{key:"dstBlendFactor",get:function(){return this._dstBlendFactor},set:function(t){this._dstBlendFactor!==t&&(this._dstBlendFactor=t,this._updateBlendFunc())}},{key:"srcBlendFactor",get:function(){return this._srcBlendFactor},set:function(t){this._srcBlendFactor!==t&&(this._srcBlendFactor=t,this._updateBlendFunc())}},{key:"color",get:function(){return this._color},set:function(t){this._color!==t&&(this._color.set(t),this.markForUpdateRenderData())}},{key:"customMaterial",get:function(){return this._customMaterial},set:function(){}}]);var o=i.prototype;return o.onLoad=function(){this._createClearModel(),this._createGraphics(),this._graphics&&this._graphics.onLoad()},o.onEnable=function(){t.prototype.onEnable.call(this),this._type!==Vn.IMAGE_STENCIL&&this._updateGraphics()},o.onRestore=function(){this._createGraphics(),this._updateGraphics()},o.onDisable=function(){t.prototype.onDisable.call(this),this._disableGraphics()},o.onDestroy=function(){t.prototype.onDestroy.call(this),this._clearModel&&St.root.destroyModel(this._clearModel),this._clearStencilMtl&&this._clearStencilMtl.destroy(),this._removeGraphics()},o.isHit=function(t){var e=this.node._uiProps.uiTransformComp,i=e.contentSize,o=i.width,n=i.height,r=Xn;this.node.getWorldMatrix(jn),S.invert(Yn,jn),D.transformMat4(r,t,Yn);var s=e.anchorPoint;r.x+=s.x*o,r.y+=s.y*n;var a=!1;if(this.type===Vn.RECT||this.type===Vn.GRAPHICS_STENCIL)a=r.x>=0&&r.y>=0&&r.x<=o&&r.y<=n;else if(this.type===Vn.ELLIPSE){var h=o/2,l=n/2,c=r.x-.5*o,u=r.y-.5*n;a=c*c/(h*h)+u*u/(l*l)<1}return this._inverted&&(a=!a),a},o._render=function(t){t.commitComp(this,null,this._assembler,null)},o._postRender=function(t){this._postAssembler&&t.commitComp(this,null,this._postAssembler,null)},o._nodeStateChange=function(e){t.prototype._nodeStateChange.call(this,e),this._type!==Vn.RECT&&this._type!==Vn.ELLIPSE||this._updateGraphics()},o._canRender=function(){return!!t.prototype._canRender.call(this)&&null!==this._graphics&&(this._type!==Vn.IMAGE_STENCIL||null!==this._spriteFrame)},o._flushAssembler=function(){var t=i.Assembler.getAssembler(this),e=i.PostAssembler.getAssembler(this);this._assembler!==t&&(this.destroyRenderData(),this._assembler=t),this._postAssembler!==e&&(this._postAssembler=e),this._useRenderData()},o._createGraphics=function(){if(!this._graphics){var t=this._graphics=new Kt;t.node=this.node,t.node.getWorldMatrix(),t.lineWidth=0;var i=e.WHITE.clone();i.a=0,t.fillColor=i}this._updateMaterial()},o._updateGraphics=function(){if(this._graphics){var t=this.node._uiProps.uiTransformComp,e=this._graphics;e.clear();var i=t.contentSize,o=i.width,n=i.height,r=t.anchorPoint,s=-o*r.x,a=-n*r.y;if(this._type===Vn.RECT)e.rect(s,a,o,n);else if(this._type===Vn.ELLIPSE){for(var l=function(t,e,i){Zn.length=0;for(var o=2*Math.PI/i,n=0;n<i;++n)Zn.push(new h(e.x*Math.cos(o*n)+t.x,e.y*Math.sin(o*n)+t.y,0));return Zn}(new h(s+o/2,a+n/2,0),new h(o/2,n/2,0),this._segments),c=0;c<l.length;++c){var u=l[c];0===c?e.moveTo(u.x,u.y):e.lineTo(u.x,u.y)}e.close()}e.fill()}},o._createClearModel=function(){if(!this._clearModel){var t,e=it.get("default-clear-stencil");this._clearStencilMtl=new ot({parent:e,owner:this,subModelIdx:0}),this._clearModel=St.root.createModel(nt),this._clearModel.name="clear-model",this._clearModel.node=this._clearModel.transform=this.node;var i=wt(Lt),o=C.director.root.device,n=o.createBuffer(new rt(st.VERTEX|st.TRANSFER_DST,at.DEVICE,4*i,i)),r=new Float32Array([-1,-1,0,1,-1,0,-1,1,0,1,1,0]);n.update(r);var s=o.createBuffer(new rt(st.INDEX|st.TRANSFER_DST,at.DEVICE,12,2)),a=new Uint16Array([0,1,2,2,1,3]);s.update(a),(t=new ht([n],Lt,lt.TRIANGLE_LIST,s)).subMeshIdx=0,this._clearModel.initSubModel(0,t,this._clearStencilMtl),(this._type!==Vn.IMAGE_STENCIL||this._spriteFrame)&&this._attachClearModel()}},o._updateMaterial=function(){if(this._graphics){var t,e=this._graphics;e.stencilStage=At.DISABLED,this._type===Vn.IMAGE_STENCIL?(t=it.get("ui-alpha-test-material"),e.setMaterial(t,0),(t=e.getMaterialInstance(0)).setProperty("alphaThreshold",this._alphaThreshold)):(t=it.get("ui-graphics-material"),e.setMaterial(t,0),e.getMaterialInstance(0))}},o._disableGraphics=function(){this._graphics&&this._graphics.onDisable()},o._removeGraphics=function(){this._graphics&&(this._graphics.destroy(),this._graphics._destroyImmediate(),this._graphics=null)},o._useRenderData=function(){this._type!==Vn.IMAGE_STENCIL||this._renderData||this._assembler&&this._assembler.createData&&(this._renderData=this._assembler.createData(this),this.markForUpdateRenderData())},o._attachClearModel=function(){this._clearModel&&St.root.ui.renderScene.addModel(this._clearModel)},o._detachClearModel=function(){this._clearModel&&St.root.ui.renderScene.removeModel(this._clearModel)},i}(bt),kn.Type=Vn,c((zn=Fn).prototype,"type",[mn,Tn,vn],Object.getOwnPropertyDescriptor(zn.prototype,"type"),zn.prototype),c(zn.prototype,"inverted",[bn,Sn],Object.getOwnPropertyDescriptor(zn.prototype,"inverted"),zn.prototype),c(zn.prototype,"segments",[Cn],Object.getOwnPropertyDescriptor(zn.prototype,"segments"),zn.prototype),c(zn.prototype,"spriteFrame",[En,On],Object.getOwnPropertyDescriptor(zn.prototype,"spriteFrame"),zn.prototype),c(zn.prototype,"alphaThreshold",[wn,Ln,P],Object.getOwnPropertyDescriptor(zn.prototype,"alphaThreshold"),zn.prototype),c(zn.prototype,"dstBlendFactor",[x,An],Object.getOwnPropertyDescriptor(zn.prototype,"dstBlendFactor"),zn.prototype),c(zn.prototype,"srcBlendFactor",[x,Dn],Object.getOwnPropertyDescriptor(zn.prototype,"srcBlendFactor"),zn.prototype),c(zn.prototype,"color",[x,Pn],Object.getOwnPropertyDescriptor(zn.prototype,"color"),zn.prototype),c(zn.prototype,"customMaterial",[x,xn],Object.getOwnPropertyDescriptor(zn.prototype,"customMaterial"),zn.prototype),Rn=c(zn.prototype,"_type",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Vn.RECT}}),Bn=c(zn.prototype,"_inverted",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Mn=c(zn.prototype,"_segments",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 64}}),Hn=c(zn.prototype,"_spriteFrame",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Nn=c(zn.prototype,"_alphaThreshold",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.1}}),In=zn))||In)||In)||In)||In));C.Mask=mr,function(t){t[t.HORIZONTAL=0]="HORIZONTAL",t[t.VERTICAL=1]="VERTICAL",t[t.FILLED=2]="FILLED"}(yr||(yr={})),b(yr),t("P",($n=o("cc.ProgressBar"),qn=u(),Kn=q(110),Qn=_(),Jn=K(Q),tr=n(Xt),er=d(),ir=n(yr),or=d(),nr=d(),rr=z(),sr=d(),ar=d(),$n(hr=qn(hr=Kn(hr=Qn(hr=Jn((gr=fr=function(t){function e(){for(var e,i=arguments.length,o=new Array(i),n=0;n<i;n++)o[n]=arguments[n];return e=t.call.apply(t,[this].concat(o))||this,y(e,"_barSprite",cr,m(e)),y(e,"_mode",ur,m(e)),y(e,"_totalLength",_r,m(e)),y(e,"_progress",pr,m(e)),y(e,"_reverse",dr,m(e)),e}s(e,t);var i=e.prototype;return i._initBarSprite=function(){if(this._barSprite){var t=this._barSprite.node;if(!t)return;var e=this.node._uiProps.uiTransformComp,i=e.contentSize,o=e.anchorPoint,n=t._uiProps.uiTransformComp.contentSize;if(this._barSprite.fillType===Xt.FillType.RADIAL&&(this._mode=yr.FILLED),this._mode===yr.HORIZONTAL?this.totalLength=n.width:this._mode===yr.VERTICAL?this.totalLength=n.height:this.totalLength=this._barSprite.fillRange,t.parent===this.node){var r=-i.width*o.x;t.setPosition(r,0,0)}}},i._updateBarStatus=function(){if(this._barSprite){var t=this._barSprite.node;if(!t)return;var e=t._uiProps.uiTransformComp,i=e.anchorPoint,o=e.contentSize,n=t.getPosition(),r=new D(0,.5),s=M(this._progress),a=this._totalLength*s,l=o,c=0,u=0;switch(this._mode){case yr.HORIZONTAL:this._reverse&&(r=new D(1,.5)),l=new L(a,o.height),c=this._totalLength,u=o.height;break;case yr.VERTICAL:r=this._reverse?new D(.5,1):new D(.5,0),l=new L(o.width,a),c=o.width,u=this._totalLength}if(this._mode===yr.FILLED)this._barSprite.type!==Xt.Type.FILLED?H("ProgressBar FILLED mode only works when barSprite's Type is FILLED!"):(this._reverse&&(a*=-1),this._barSprite.fillRange=a);else if(this._barSprite.type!==Xt.Type.FILLED){var _=r.x-i.x,p=r.y-i.y,d=new h(c*_,u*p,0);t.setPosition(n.x+d.x,n.y+d.y,n.z),e.setAnchorPoint(r),e.setContentSize(l)}else H("ProgressBar non-FILLED mode only works when barSprite's Type is non-FILLED!")}},l(e,[{key:"barSprite",get:function(){return this._barSprite},set:function(t){this._barSprite!==t&&(this._barSprite=t,this._initBarSprite())}},{key:"mode",get:function(){return this._mode},set:function(t){if(this._mode!==t&&(this._mode=t,this._barSprite)){var e=this._barSprite.node;if(!e)return;var i=e._uiProps.uiTransformComp.contentSize;this._mode===yr.HORIZONTAL?this.totalLength=i.width:this._mode===yr.VERTICAL?this.totalLength=i.height:this._mode===yr.FILLED&&(this.totalLength=this._barSprite.fillRange)}}},{key:"totalLength",get:function(){return this._totalLength},set:function(t){this._mode===yr.FILLED&&(t=M(t)),this._totalLength=t,this._updateBarStatus()}},{key:"progress",get:function(){return this._progress},set:function(t){this._progress!==t&&(this._progress=t,this._updateBarStatus())}},{key:"reverse",get:function(){return this._reverse},set:function(t){this._reverse!==t&&(this._reverse=t,this._barSprite&&(this._barSprite.fillStart=1-this._barSprite.fillStart),this._updateBarStatus())}}]),e}(T),fr.Mode=yr,c((lr=gr).prototype,"barSprite",[tr,er],Object.getOwnPropertyDescriptor(lr.prototype,"barSprite"),lr.prototype),c(lr.prototype,"mode",[ir,or],Object.getOwnPropertyDescriptor(lr.prototype,"mode"),lr.prototype),c(lr.prototype,"totalLength",[nr],Object.getOwnPropertyDescriptor(lr.prototype,"totalLength"),lr.prototype),c(lr.prototype,"progress",[rr,P,sr],Object.getOwnPropertyDescriptor(lr.prototype,"progress"),lr.prototype),c(lr.prototype,"reverse",[ar],Object.getOwnPropertyDescriptor(lr.prototype,"reverse"),lr.prototype),cr=c(lr.prototype,"_barSprite",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ur=c(lr.prototype,"_mode",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return yr.HORIZONTAL}}),_r=c(lr.prototype,"_totalLength",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),pr=c(lr.prototype,"_progress",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.1}}),dr=c(lr.prototype,"_reverse",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),hr=lr))||hr)||hr)||hr)||hr)||hr));var Tr,vr,br,Sr,Cr,Er,Or,wr,Lr,Ar,Dr,Pr,xr,Ir,zr,Rr,Br,Mr,Hr,Nr,kr,Fr,Vr,Ur,Gr,Wr,jr,Xr,Yr,Zr,$r,qr,Kr,Qr,Jr,ts,es,is,os,ns,rs,ss,as,hs,ls,cs,us,_s=t("L",(Tr=o("cc.LabelOutline"),vr=u(),br=q(110),Sr=_(),Cr=K(Yt),Er=d(),Or=d(),Tr(wr=vr(wr=br(wr=Sr(wr=Cr(wr=r((Pr=function(t){function e(){for(var e,i=arguments.length,o=new Array(i),n=0;n<i;n++)o[n]=arguments[n];return e=t.call.apply(t,[this].concat(o))||this,y(e,"_color",Ar,m(e)),y(e,"_width",Dr,m(e)),e}s(e,t);var i=e.prototype;return i.onEnable=function(){this._updateRenderData()},i.onDisable=function(){this._updateRenderData()},i._updateRenderData=function(){var t=this.node.getComponent(Yt);t&&t.updateRenderData(!0)},l(e,[{key:"color",get:function(){return this._color},set:function(t){this._color!==t&&(this._color.set(t),this._updateRenderData())}},{key:"width",get:function(){return this._width},set:function(t){this._width!==t&&(this._width=t,this._updateRenderData())}}]),e}(T),Ar=c((Lr=Pr).prototype,"_color",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new e(0,0,0,255)}}),Dr=c(Lr.prototype,"_width",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),c(Lr.prototype,"color",[Er],Object.getOwnPropertyDescriptor(Lr.prototype,"color"),Lr.prototype),c(Lr.prototype,"width",[Or],Object.getOwnPropertyDescriptor(Lr.prototype,"width"),Lr.prototype),wr=Lr))||wr)||wr)||wr)||wr)||wr)||wr)),ps=new ut,ds=new N((function(t){if(!C.isValid(t.node))return!1;var e=t.node.getComponent(_s);return e&&(e.width=0),!0}),20);ds.get=function(t){var e=this._get();e||(e={node:new Dt("RICHTEXT_CHILD"),comp:null,lineCount:0,styleIndex:0,imageOffset:"",clickParam:"",clickHandler:""});var i=e.node;i||(i=new Dt("RICHTEXT_CHILD"));var o=i.getComponent(Yt);return o||(o=i.addComponent(Yt)),o.string=t,o.horizontalAlign=$t.LEFT,o.verticalAlign=Zt.TOP,i.setPosition(0,0,0),i._uiProps.uiTransformComp.setAnchorPoint(.5,.5),{node:i,comp:o,lineCount:0,styleIndex:0,imageOffset:"",clickParam:"",clickHandler:""}},t("R",(xr=o("cc.RichText"),Ir=u(),zr=q(110),Rr=_(),Br=d(),Mr=n($t),Hr=d(),Nr=d(),kr=d(),Fr=n(Pt),Vr=d(),Ur=d(),Gr=n(qt),Wr=d(),jr=d(),Xr=d(),Yr=n(xt),Zr=d(),$r=d(),xr(qr=Ir(qr=zr(qr=Rr(qr=r((us=cs=function(t){function i(){var e;return e=t.call(this)||this,y(e,"_lineHeight",Qr,m(e)),y(e,"_string",Jr,m(e)),y(e,"_horizontalAlign",ts,m(e)),y(e,"_fontSize",es,m(e)),y(e,"_maxWidth",is,m(e)),y(e,"_fontFamily",os,m(e)),y(e,"_font",ns,m(e)),y(e,"_isSystemFontUsed",rs,m(e)),y(e,"_userDefinedFont",ss,m(e)),y(e,"_cacheMode",as,m(e)),y(e,"_imageAtlas",hs,m(e)),y(e,"_handleTouchEvent",ls,m(e)),e._textArray=[],e._labelSegments=[],e._labelSegmentsCache=[],e._linesWidth=[],e._lineCount=1,e._labelWidth=0,e._labelHeight=0,e._layoutDirty=!0,e._lineOffsetX=0,e._updateRichTextStatus=void 0,e._updateRichTextStatus=e._updateRichText,e}s(i,t),l(i,[{key:"string",get:function(){return this._string},set:function(t){this._string!==t&&(this._string=t,this._updateRichTextStatus())}},{key:"horizontalAlign",get:function(){return this._horizontalAlign},set:function(t){this.horizontalAlign!==t&&(this._horizontalAlign=t,this._layoutDirty=!0,this._updateRichTextStatus())}},{key:"fontSize",get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this._layoutDirty=!0,this._updateRichTextStatus())}},{key:"fontFamily",get:function(){return this._fontFamily},set:function(t){this._fontFamily!==t&&(this._fontFamily=t,this._layoutDirty=!0,this._updateRichTextStatus())}},{key:"font",get:function(){return this._font},set:function(t){this._font!==t&&(this._font=t,this._layoutDirty=!0,this._font?(this.useSystemFont=!1,this._onTTFLoaded()):this.useSystemFont=!0,this._updateRichTextStatus())}},{key:"useSystemFont",get:function(){return this._isSystemFontUsed},set:function(t){this._isSystemFontUsed!==t&&(this._isSystemFontUsed=t,this._layoutDirty=!0,this._updateRichTextStatus())}},{key:"cacheMode",get:function(){return this._cacheMode},set:function(t){this._cacheMode!==t&&(this._cacheMode=t,this._updateRichTextStatus())}},{key:"maxWidth",get:function(){return this._maxWidth},set:function(t){this._maxWidth!==t&&(this._maxWidth=t,this._layoutDirty=!0,this._updateRichTextStatus())}},{key:"lineHeight",get:function(){return this._lineHeight},set:function(t){this._lineHeight!==t&&(this._lineHeight=t,this._layoutDirty=!0,this._updateRichTextStatus())}},{key:"imageAtlas",get:function(){return this._imageAtlas},set:function(t){this._imageAtlas!==t&&(this._imageAtlas=t,this._layoutDirty=!0,this._updateRichTextStatus())}},{key:"handleTouchEvent",get:function(){return this._handleTouchEvent},set:function(t){this._handleTouchEvent!==t&&(this._handleTouchEvent=t,this.enabledInHierarchy&&(this.handleTouchEvent?this._addEventListeners():this._removeEventListeners()))}}]);var o=i.prototype;return o.onEnable=function(){this.handleTouchEvent&&this._addEventListeners(),this._updateRichText(),this._activateChildren(!0)},o.onDisable=function(){this.handleTouchEvent&&this._removeEventListeners(),this._activateChildren(!1)},o.start=function(){this._onTTFLoaded(),this.node.on(X.EventType.ANCHOR_CHANGED,this._updateRichTextPosition,this)},o.onRestore=function(){},o.onDestroy=function(){for(var t,e=k(this._labelSegments);!(t=e()).done;){var i=t.value;i.node.removeFromParent(),ds.put(i)}this.node.off(X.EventType.ANCHOR_CHANGED,this._updateRichTextPosition,this)},o._addEventListeners=function(){this.node.on(X.EventType.TOUCH_END,this._onTouchEnded,this)},o._removeEventListeners=function(){this.node.off(X.EventType.TOUCH_END,this._onTouchEnded,this)},o._updateLabelSegmentTextAttributes=function(){var t=this;this._labelSegments.forEach((function(e){t._applyTextAttribute(e)}))},o._createFontLabel=function(t){return ds.get(t,this)},o._onTTFLoaded=function(){var t=this;this._font instanceof It?this._font._nativeAsset?(this._layoutDirty=!0,this._updateRichText()):zt.postLoadNative(this._font,(function(){t.isValid&&(t._layoutDirty=!0,t._updateRichText())})):(this._layoutDirty=!0,this._updateRichText())},o._measureText=function(t,e){var i=this,o=function(e){var o;return 0===i._labelSegmentsCache.length?(o=i._createFontLabel(e),i._labelSegmentsCache.push(o)):(o=i._labelSegmentsCache[0]).node.getComponent(Yt).string=e,o.styleIndex=t,i._applyTextAttribute(o),o.node._uiProps.uiTransformComp.contentSize.width};return e?o(e):o},o._onTouchEnded=function(t){for(var e,i=this,o=this.node.getComponents(T),n=function(){var n=e.value,r=n.clickHandler,s=n.clickParam;r&&i._containsTouchLocation(n,t.touch.getUILocation())&&(o.forEach((function(e){var i=e[r];e.enabledInHierarchy&&i&&i.call(e,t,s)})),t.propagationStopped=!0)},r=k(this._labelSegments);!(e=r()).done;)n()},o._containsTouchLocation=function(t,e){var i=t.node.getComponent(Q);return!!i&&i.getBoundingBoxToWorld().contains(e)},o._resetState=function(){for(var t=this,e=this.node.children,i=function(i){var o=e[i];if(("RICHTEXT_CHILD"===o.name||"RICHTEXT_Image_CHILD"===o.name)&&(o.parent===t.node?o.parent=null:e.splice(i,1),"RICHTEXT_CHILD"===o.name)){var n=t._labelSegments.findIndex((function(t){return t.node===o}));-1!==n&&ds.put(t._labelSegments[n])}},o=e.length-1;o>=0;o--)i(o);e.length=0,this._labelSegments.length=0,this._labelSegmentsCache.length=0,this._linesWidth.length=0,this._lineOffsetX=0,this._lineCount=1,this._labelWidth=0,this._labelHeight=0,this._layoutDirty=!0},o._activateChildren=function(t){for(var e=this.node.children.length-1;e>=0;e--){var i=this.node.children[e];"RICHTEXT_CHILD"!==i.name&&"RICHTEXT_Image_CHILD"!==i.name||(i.active=t)}},o._addLabelSegment=function(t,e){var i;if(0===this._labelSegmentsCache.length)i=this._createFontLabel(t);else{var o=(i=this._labelSegmentsCache.pop()).node.getComponent(Yt);o&&(o.string=t)}return i.styleIndex=e,i.lineCount=this._lineCount,i.node._uiProps.uiTransformComp.setAnchorPoint(0,0),this._applyTextAttribute(i),this.node.addChild(i.node),this._labelSegments.push(i),i},o._updateRichTextWithMaxWidth=function(t,e,i){var o=e;if(this._lineOffsetX>0&&o+this._lineOffsetX>this._maxWidth)for(var n=0;this._lineOffsetX<=this._maxWidth;){var r=this._getFirstWordLen(t,n,t.length),s=t.substr(n,r),a=this._measureText(i,s);if(!(this._lineOffsetX+a<=this._maxWidth)){if(n>0){var h=t.substr(0,n);this._addLabelSegment(h,i),t=t.substr(n,t.length),o=this._measureText(i,t)}this._updateLineInfo();break}this._lineOffsetX+=a,n+=r}if(o>this._maxWidth)for(var l=_t(t,o,this._maxWidth,this._measureText(i)),c=0;c<l.length;++c){var u=l[c],_=this._addLabelSegment(u,i).node._uiProps.uiTransformComp.contentSize;this._lineOffsetX+=_.width,l.length>1&&c<l.length-1&&this._updateLineInfo()}else this._lineOffsetX+=o,this._addLabelSegment(t,i)},o._isLastComponentCR=function(t){return t.length-1===t.lastIndexOf("\n")},o._updateLineInfo=function(){this._linesWidth.push(this._lineOffsetX),this._lineOffsetX=0,this._lineCount++},o._needsUpdateTextLayout=function(t){if(this._layoutDirty||!this._textArray||!t)return!0;if(this._textArray.length!==t.length)return!0;for(var e=0;e<this._textArray.length;e++){var i=this._textArray[e],o=t[e];if(i.text!==o.text)return!0;var n=i.style,r=o.style;if(n){if(r){if(!!r.outline!=!!n.outline)return!0;if(n.size!==r.size||n.italic!==r.italic||n.isImage!==r.isImage)return!0;if(n.src!==r.src||n.imageAlign!==r.imageAlign||n.imageHeight!==r.imageHeight||n.imageWidth!==r.imageWidth||n.imageOffset!==r.imageOffset)return!0}else if(n.size||n.italic||n.isImage||n.outline)return!0}else if(r&&(r.size||r.italic||r.isImage||r.outline))return!0}return!1},o._addRichTextImageElement=function(t){if(t.style){var e=t.style,i=e.src,o=this._imageAtlas&&i&&this._imageAtlas.getSpriteFrame(i);if(o){var n=new Dt("RICHTEXT_Image_CHILD"),r=n.addComponent(Xt);switch(e.imageAlign){case"top":n._uiProps.uiTransformComp.setAnchorPoint(0,1);break;case"center":n._uiProps.uiTransformComp.setAnchorPoint(0,.5);break;default:n._uiProps.uiTransformComp.setAnchorPoint(0,0)}r.type=Xt.Type.SLICED,r.sizeMode=Xt.SizeMode.CUSTOM,r.spriteFrame=o,this.node.addChild(n);var s={node:n,comp:r,lineCount:0,styleIndex:0,imageOffset:e.imageOffset||"",clickParam:"",clickHandler:""};this._labelSegments.push(s);var a=o.rect.clone(),h=1,l=a.width,c=a.height,u=e.imageWidth||0,_=e.imageHeight||0;_>0?(l*=h=_/c,c*=h):(l*=h=this._lineHeight/c,c*=h),u>0&&(l=u),this._maxWidth>0?(this._lineOffsetX+l>this._maxWidth&&this._updateLineInfo(),this._lineOffsetX+=l):(this._lineOffsetX+=l,this._lineOffsetX>this._labelWidth&&(this._labelWidth=this._lineOffsetX)),n._uiProps.uiTransformComp.setContentSize(l,c),s.lineCount=this._lineCount,s.clickHandler="",s.clickParam="";var p=e.event;p&&(s.clickHandler=p.click,s.clickParam=p.param)}else R(4400)}},o._updateRichText=function(){if(this.enabledInHierarchy){var t=ps.parse(this._string);if(!this._needsUpdateTextLayout(t))return this._textArray=t.slice(),void this._updateLabelSegmentTextAttributes();this._textArray=t.slice(),this._resetState();for(var e,i=!1,o=0;o<this._textArray.length;++o){var n=this._textArray[o],r=n.text;if(void 0!==r){if(""===r){if(n.style&&n.style.isNewLine){this._updateLineInfo();continue}if(n.style&&n.style.isImage&&this._imageAtlas){this._addRichTextImageElement(n);continue}}for(var s=r.split("\n"),a=0;a<s.length;++a){var h=s[a];if(""!==h)if(i=!1,this._maxWidth>0){var l=this._measureText(o,h);this._updateRichTextWithMaxWidth(h,l,o),s.length>1&&a<s.length-1&&this._updateLineInfo()}else e=this._addLabelSegment(h,o),this._lineOffsetX+=e.node._uiProps.uiTransformComp.width,this._lineOffsetX>this._labelWidth&&(this._labelWidth=this._lineOffsetX),s.length>1&&a<s.length-1&&this._updateLineInfo();else{if(this._isLastComponentCR(r)&&a===s.length-1)continue;this._updateLineInfo(),i=!0}}}}i||this._linesWidth.push(this._lineOffsetX),this._maxWidth>0&&(this._labelWidth=this._maxWidth),this._labelHeight=(this._lineCount+pt)*this._lineHeight,this.node._uiProps.uiTransformComp.setContentSize(this._labelWidth,this._labelHeight),this._updateRichTextPosition(),this._layoutDirty=!1}},o._getFirstWordLen=function(t,e,i){var o=t.charAt(e);if(dt(o)||ft(o))return 1;for(var n=1,r=e+1;r<i&&(o=t.charAt(r),!ft(o)&&!dt(o));++r)n++;return n},o._updateRichTextPosition=function(){for(var t=0,e=1,i=this._lineCount,o=this.node._uiProps.uiTransformComp,n=o.anchorX,r=o.anchorY,s=0;s<this._labelSegments.length;++s){var a=this._labelSegments[s],h=a.lineCount;h>e&&(t=0,e=h);var l=this._labelWidth*(.5*this._horizontalAlign-n);switch(this._horizontalAlign){case $t.LEFT:break;case $t.CENTER:l-=this._linesWidth[h-1]/2;break;case $t.RIGHT:l-=this._linesWidth[h-1]}var c=a.node.position;if(a.node.setPosition(t+l,this._lineHeight*(i-h)-this._labelHeight*r,c.z),h===e&&(t+=a.node._uiProps.uiTransformComp.width),a.node.getComponent(Xt)){var u=a.node.position.clone(),_=this._lineHeight,p=this._lineHeight*(1+pt);switch(a.node._uiProps.uiTransformComp.anchorY){case 1:u.y+=_+(p-_)/2;break;case.5:u.y+=p/2;break;default:u.y+=(p-_)/2}if(a.imageOffset){var d=a.imageOffset.split(",");if(1===d.length&&d[0]){var f=parseFloat(d[0]);Number.isInteger(f)&&(u.y+=f)}else if(2===d.length){var g=parseFloat(d[0]),y=parseFloat(d[1]);Number.isInteger(g)&&(u.x+=g),Number.isInteger(y)&&(u.y+=y)}}a.node.position=u}var m=a.node.getComponent(_s);if(m){var T=a.node.position.clone();T.y=T.y-m.width,a.node.position=T}}},o._convertLiteralColorValue=function(t){var i=t.toUpperCase();return e[i]?e[i]:(new e).fromHEX(t)},o._applyTextAttribute=function(t){var e=t.node.getComponent(Yt);if(e){var i,o=t.styleIndex;if(this._textArray[o]&&(i=this._textArray[o].style),i){if(e.color=this._convertLiteralColorValue(i.color||"white"),e.isBold=!!i.bold,e.isItalic=!!i.italic,e.isUnderline=!!i.underline,i.outline){var n=t.node.getComponent(_s);n||(n=t.node.addComponent(_s)),n.color=this._convertLiteralColorValue(i.outline.color),n.width=i.outline.width}e.fontSize=i.size||this._fontSize,t.clickHandler="",t.clickParam="";var r=i.event;r&&(t.clickHandler=r.click||"",t.clickParam=r.param||"")}else e.fontSize=this._fontSize;e.cacheMode=this._cacheMode,this._font instanceof Pt&&!this._isSystemFontUsed?e.font=this._font:e.fontFamily=this._fontFamily,e.useSystemFont=this._isSystemFontUsed,e.lineHeight=this._lineHeight,e.updateRenderData(!0)}},i}(Rt),cs.HorizontalAlign=$t,cs.VerticalAlign=Zt,c((Kr=us).prototype,"string",[F,Br],Object.getOwnPropertyDescriptor(Kr.prototype,"string"),Kr.prototype),c(Kr.prototype,"horizontalAlign",[Mr,Hr],Object.getOwnPropertyDescriptor(Kr.prototype,"horizontalAlign"),Kr.prototype),c(Kr.prototype,"fontSize",[Nr],Object.getOwnPropertyDescriptor(Kr.prototype,"fontSize"),Kr.prototype),c(Kr.prototype,"fontFamily",[kr],Object.getOwnPropertyDescriptor(Kr.prototype,"fontFamily"),Kr.prototype),c(Kr.prototype,"font",[Fr,Vr],Object.getOwnPropertyDescriptor(Kr.prototype,"font"),Kr.prototype),c(Kr.prototype,"useSystemFont",[Ur],Object.getOwnPropertyDescriptor(Kr.prototype,"useSystemFont"),Kr.prototype),c(Kr.prototype,"cacheMode",[Gr,Wr],Object.getOwnPropertyDescriptor(Kr.prototype,"cacheMode"),Kr.prototype),c(Kr.prototype,"maxWidth",[jr],Object.getOwnPropertyDescriptor(Kr.prototype,"maxWidth"),Kr.prototype),c(Kr.prototype,"lineHeight",[Xr],Object.getOwnPropertyDescriptor(Kr.prototype,"lineHeight"),Kr.prototype),c(Kr.prototype,"imageAtlas",[Yr,Zr],Object.getOwnPropertyDescriptor(Kr.prototype,"imageAtlas"),Kr.prototype),c(Kr.prototype,"handleTouchEvent",[$r],Object.getOwnPropertyDescriptor(Kr.prototype,"handleTouchEvent"),Kr.prototype),Qr=c(Kr.prototype,"_lineHeight",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 40}}),Jr=c(Kr.prototype,"_string",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"<color=#00ff00>Rich</color><color=#0fffff>Text</color>"}}),ts=c(Kr.prototype,"_horizontalAlign",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return $t.LEFT}}),es=c(Kr.prototype,"_fontSize",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 40}}),is=c(Kr.prototype,"_maxWidth",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),os=c(Kr.prototype,"_fontFamily",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"Arial"}}),ns=c(Kr.prototype,"_font",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),rs=c(Kr.prototype,"_isSystemFontUsed",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),ss=c(Kr.prototype,"_userDefinedFont",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),as=c(Kr.prototype,"_cacheMode",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return qt.NONE}}),hs=c(Kr.prototype,"_imageAtlas",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ls=c(Kr.prototype,"_handleTouchEvent",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),qr=Kr))||qr)||qr)||qr)||qr)||qr));var fs,gs,ys,ms,Ts,vs,bs,Ss,Cs,Es,Os,ws,Ls,As,Ds,Ps,xs,Is,zs,Rs,Bs,Ms,Hs,Ns,ks,Fs=new h,Vs=new h,Us=new h,Gs=new D,Ws=new e;!function(t){t[t.HORIZONTAL=0]="HORIZONTAL",t[t.VERTICAL=1]="VERTICAL"}(ks||(ks={})),i(ks);var js,Xs,Ys,Zs,$s,qs,Ks,Qs,Js,ta,ea,ia,oa,na,ra,sa,aa,ha,la,ca,ua,_a,pa,da,fa,ga,ya,ma,Ta,va,ba,Sa,Ca,Ea,Oa,wa,La,Aa,Da,Pa,xa,Ia,za,Ra,Ba,Ma,Ha,Na,ka,Fa=t("d",(fs=o("cc.ScrollBar"),gs=u(),ys=q(110),ms=_(),Ts=K(Q),vs=n(Xt),bs=p(),Ss=d(),Cs=n(ks),Es=p(),Os=d(),ws=p(),Ls=d(),As=p(),Ds=d(),fs(Ps=gs(Ps=ys(Ps=ms(Ps=Ts((Ns=Hs=function(t){function e(){for(var e,i=arguments.length,o=new Array(i),n=0;n<i;n++)o[n]=arguments[n];return e=t.call.apply(t,[this].concat(o))||this,y(e,"_scrollView",Is,m(e)),y(e,"_handle",zs,m(e)),y(e,"_direction",Rs,m(e)),y(e,"_enableAutoHide",Bs,m(e)),y(e,"_autoHideTime",Ms,m(e)),e._touching=!1,e._opacity=255,e._autoHideRemainingTime=0,e}s(e,t);var i=e.prototype;return i.hide=function(){this._autoHideRemainingTime=0,this._setOpacity(0)},i.show=function(){this._autoHideRemainingTime=this._autoHideTime,this._setOpacity(this._opacity)},i.onScroll=function(t){if(this._scrollView){var e=this._scrollView.content;if(e){var i=e._uiProps.uiTransformComp.contentSize,o=this._scrollView.node._uiProps.uiTransformComp.contentSize,n=this.node._uiProps.uiTransformComp.contentSize;if(!this._conditionalDisableScrollBar(i,o)){this._enableAutoHide&&(this._autoHideRemainingTime=this._autoHideTime,this._setOpacity(this._opacity));var r=0,s=0,a=0,h=0,l=0;this._direction===ks.HORIZONTAL?(r=i.width,s=o.width,l=n.width,a=t.x,h=-this._convertToScrollViewSpace(e).x):this._direction===ks.VERTICAL&&(r=i.height,s=o.height,l=n.height,a=t.y,h=-this._convertToScrollViewSpace(e).y);var c=this._calculateLength(r,s,l,a),u=this._calculatePosition(r,s,l,h,a,c);this._updateLength(c),this._updateHandlerPosition(u)}}}},i.setScrollView=function(t){this._scrollView=t},i.onTouchBegan=function(){this._enableAutoHide&&(this._touching=!0)},i.onTouchEnded=function(){if(this._enableAutoHide&&(this._touching=!1,!(this._autoHideTime<=0))){if(this._scrollView){var t=this._scrollView.content;if(t){var e=t._uiProps.uiTransformComp.contentSize,i=this._scrollView.node._uiProps.uiTransformComp.contentSize;if(this._conditionalDisableScrollBar(e,i))return}}this._autoHideRemainingTime=this._autoHideTime}},i.onEnable=function(){var t=this.node.getComponent(Xt);t&&(this._opacity=t.color.a)},i.start=function(){this._enableAutoHide&&this._setOpacity(0)},i.update=function(t){this._processAutoHide(t)},i._convertToScrollViewSpace=function(t){var e=this._scrollView&&this._scrollView.node._uiProps.uiTransformComp,i=t._uiProps.uiTransformComp;if(!e||!i)return Fs;Vs.set(-i.anchorX*i.width,-i.anchorY*i.height,0),i.convertToWorldSpaceAR(Vs,Us);var o=e.convertToNodeSpaceAR(Us);return o.x+=e.anchorX*e.width,o.y+=e.anchorY*e.height,o},i._setOpacity=function(t){if(this._handle){var e=this.node.getComponent(Xt);e&&(Ws.set(e.color),Ws.a=t,e.color=Ws),(e=this._handle.getComponent(Xt))&&(Ws.set(e.color),Ws.a=t,e.color=Ws)}},i._updateHandlerPosition=function(t){if(this._handle){var e=this._fixupHandlerPosition();this._handle.node.setPosition(t.x+e.x,t.y+e.y,e.z)}},i._fixupHandlerPosition=function(){var t=this.node._uiProps.uiTransformComp,e=t.contentSize,i=t.anchorPoint,o=this.handle.node._uiProps.uiTransformComp.contentSize,n=this.handle.node.parent;h.set(Vs,-e.width*i.x,-e.height*i.y,0);var r=this.node._uiProps.uiTransformComp.convertToWorldSpaceAR(Vs,Us),s=new h;return n._uiProps.uiTransformComp.convertToNodeSpaceAR(r,s),this.direction===ks.HORIZONTAL?s=new h(s.x,s.y+(e.height-o.height)/2,0):this.direction===ks.VERTICAL&&(s=new h(s.x+(e.width-o.width)/2,s.y,0)),this.handle.node.setPosition(s),s},i._conditionalDisableScrollBar=function(t,e){return t.width<=e.width&&this._direction===ks.HORIZONTAL||t.height<=e.height&&this._direction===ks.VERTICAL},i._calculateLength=function(t,e,i,o){var n=t;return o&&(n+=20*(o>0?o:-o)),i*(e/n)},i._calculatePosition=function(t,e,i,o,n,r){var s=t-e;n&&(s+=Math.abs(n));var a=0;s&&(a=M(a=o/s));var l=(i-r)*a;return this._direction===ks.VERTICAL?new h(0,l,0):new h(l,0,0)},i._updateLength=function(t){if(this._handle){var e=this._handle.node._uiProps.uiTransformComp,i=e.contentSize,o=e.anchorPoint;o.x===Gs.x&&o.y===Gs.y||e.setAnchorPoint(Gs),this._direction===ks.HORIZONTAL?e.setContentSize(t,i.height):e.setContentSize(i.width,t)}},i._processAutoHide=function(t){if(this._enableAutoHide&&!(this._autoHideRemainingTime<=0)&&!this._touching&&(this._autoHideRemainingTime-=t,this._autoHideRemainingTime<=this._autoHideTime)){this._autoHideRemainingTime=Math.max(0,this._autoHideRemainingTime);var e=this._opacity*(this._autoHideRemainingTime/this._autoHideTime);this._setOpacity(e)}},l(e,[{key:"handle",get:function(){return this._handle},set:function(t){this._handle!==t&&(this._handle=t,this.onScroll(Fs))}},{key:"direction",get:function(){return this._direction},set:function(t){this._direction!==t&&(this._direction=t,this.onScroll(new h))}},{key:"enableAutoHide",get:function(){return this._enableAutoHide},set:function(t){this._enableAutoHide!==t&&(this._enableAutoHide=t,this._enableAutoHide&&this._setOpacity(0))}},{key:"autoHideTime",get:function(){return this._autoHideTime},set:function(t){this._autoHideTime!==t&&(this._autoHideTime=t)}}]),e}(T),Hs.Direction=ks,c((xs=Ns).prototype,"handle",[vs,bs,Ss],Object.getOwnPropertyDescriptor(xs.prototype,"handle"),xs.prototype),c(xs.prototype,"direction",[Cs,Es,Os],Object.getOwnPropertyDescriptor(xs.prototype,"direction"),xs.prototype),c(xs.prototype,"enableAutoHide",[ws,Ls],Object.getOwnPropertyDescriptor(xs.prototype,"enableAutoHide"),xs.prototype),c(xs.prototype,"autoHideTime",[As,Ds],Object.getOwnPropertyDescriptor(xs.prototype,"autoHideTime"),xs.prototype),Is=c(xs.prototype,"_scrollView",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),zs=c(xs.prototype,"_handle",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Rs=c(xs.prototype,"_direction",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return ks.HORIZONTAL}}),Bs=c(xs.prototype,"_enableAutoHide",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ms=c(xs.prototype,"_autoHideTime",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Ps=xs))||Ps)||Ps)||Ps)||Ps)||Ps)),Va=t("V",o("cc.ViewGroup")(js=q(110)(js=function(t){function e(){return t.apply(this,arguments)||this}return s(e,t),e}(T))||js)||js);C.ViewGroup=Va;var Ua,Ga=new h,Wa=new h,ja=new h,Xa=new D,Ya=new D,Za=function(){return(new Date).getMilliseconds()},$a={"scroll-to-top":0,"scroll-to-bottom":1,"scroll-to-left":2,"scroll-to-right":3,scrolling:4,"bounce-bottom":6,"bounce-left":7,"bounce-right":8,"bounce-top":5,"scroll-ended":9,"touch-up":10,"scroll-ended-with-threshold":11,"scroll-began":12};!function(t){t.SCROLL_TO_TOP="scroll-to-top",t.SCROLL_TO_BOTTOM="scroll-to-bottom",t.SCROLL_TO_LEFT="scroll-to-left",t.SCROLL_TO_RIGHT="scroll-to-right",t.SCROLL_BEGAN="scroll-began",t.SCROLL_ENDED="scroll-ended",t.BOUNCE_TOP="bounce-top",t.BOUNCE_BOTTOM="bounce-bottom",t.BOUNCE_LEFT="bounce-left",t.BOUNCE_RIGHT="bounce-right",t.SCROLLING="scrolling",t.SCROLL_ENG_WITH_THRESHOLD="scroll-ended-with-threshold",t.TOUCH_UP="touch-up"}(Ua||(Ua={}));var qa,Ka,Qa,Ja,th,eh,ih,oh,nh,rh,sh,ah,hh,lh,ch,uh,_h,ph,dh,fh,gh,yh,mh,Th,vh,bh,Sh,Ch,Eh,Oh,wh,Lh,Ah,Dh,Ph,xh,Ih,zh,Rh,Bh,Mh,Hh,Nh=t("S",(Xs=o("cc.ScrollView"),Ys=u(),Zs=q(110),$s=_(),qs=K(Q),Ks=z(),Qs=p(),Js=d(),ta=z(),ea=p(),ia=d(),oa=p(),na=d(),ra=p(),sa=d(),aa=n(X),ha=p(),la=d(),ca=p(),ua=d(),_a=n(Fa),pa=p(),da=d(),fa=p(),ga=d(),ya=n(Fa),ma=p(),Ta=d(),va=p(),ba=d(),Sa=n([vt]),Ca=p(),Ea=d(),Xs(Oa=Ys(Oa=Zs(Oa=$s(Oa=qs((ka=Na=function(t){function e(){for(var e,i=arguments.length,o=new Array(i),n=0;n<i;n++)o[n]=arguments[n];return e=t.call.apply(t,[this].concat(o))||this,y(e,"bounceDuration",La,m(e)),y(e,"brake",Aa,m(e)),y(e,"elastic",Da,m(e)),y(e,"inertia",Pa,m(e)),y(e,"horizontal",xa,m(e)),y(e,"vertical",Ia,m(e)),y(e,"cancelInnerEvents",za,m(e)),y(e,"scrollEvents",Ra,m(e)),e._autoScrolling=!1,e._scrolling=!1,y(e,"_content",Ba,m(e)),y(e,"_horizontalScrollBar",Ma,m(e)),y(e,"_verticalScrollBar",Ha,m(e)),e._topBoundary=0,e._bottomBoundary=0,e._leftBoundary=0,e._rightBoundary=0,e._touchMoveDisplacements=[],e._touchMoveTimeDeltas=[],e._touchMovePreviousTimestamp=0,e._touchMoved=!1,e._autoScrollAttenuate=!1,e._autoScrollStartPosition=new h,e._autoScrollTargetDelta=new h,e._autoScrollTotalTime=0,e._autoScrollAccumulatedTime=0,e._autoScrollCurrentlyOutOfBoundary=!1,e._autoScrollBraking=!1,e._autoScrollBrakingStartPosition=new h,e._outOfBoundaryAmount=new h,e._outOfBoundaryAmountDirty=!0,e._stopMouseWheel=!1,e._mouseWheelEventElapsedTime=0,e._isScrollEndedWithThresholdEventFired=!1,e._scrollEventEmitMask=0,e._isBouncing=!1,e._contentPos=new h,e._deltaPos=new h,e}s(e,t);var i=e.prototype;return i.scrollToBottom=function(t,e){void 0===e&&(e=!0);var i=this._calculateMovePercentDelta({anchor:new D(0,0),applyToHorizontal:!1,applyToVertical:!0});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i,!0)},i.scrollToTop=function(t,e){void 0===e&&(e=!0);var i=this._calculateMovePercentDelta({anchor:new D(0,1),applyToHorizontal:!1,applyToVertical:!0});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i)},i.scrollToLeft=function(t,e){void 0===e&&(e=!0);var i=this._calculateMovePercentDelta({anchor:new D(0,0),applyToHorizontal:!0,applyToVertical:!1});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i)},i.scrollToRight=function(t,e){void 0===e&&(e=!0);var i=this._calculateMovePercentDelta({anchor:new D(1,0),applyToHorizontal:!0,applyToVertical:!1});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i)},i.scrollToTopLeft=function(t,e){void 0===e&&(e=!0);var i=this._calculateMovePercentDelta({anchor:new D(0,1),applyToHorizontal:!0,applyToVertical:!0});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i)},i.scrollToTopRight=function(t,e){void 0===e&&(e=!0);var i=this._calculateMovePercentDelta({anchor:new D(1,1),applyToHorizontal:!0,applyToVertical:!0});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i)},i.scrollToBottomLeft=function(t,e){void 0===e&&(e=!0);var i=this._calculateMovePercentDelta({anchor:new D(0,0),applyToHorizontal:!0,applyToVertical:!0});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i)},i.scrollToBottomRight=function(t,e){void 0===e&&(e=!0);var i=this._calculateMovePercentDelta({anchor:new D(1,0),applyToHorizontal:!0,applyToVertical:!0});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i)},i.scrollToOffset=function(t,e,i){void 0===i&&(i=!0);var o=this.getMaxScrollOffset(),n=new D(0,0);0===o.x?n.x=0:n.x=t.x/o.x,0===o.y?n.y=1:n.y=(o.y-t.y)/o.y,this.scrollTo(n,e,i)},i.getScrollOffset=function(){var t=this._getContentTopBoundary()-this._topBoundary,e=this._getContentLeftBoundary()-this._leftBoundary;return new h(e,t,0)},i.getMaxScrollOffset=function(){if(!this._content||!this.view)return Ga;var t=this._content._uiProps.uiTransformComp.contentSize,e=t.width-this.view.width,i=t.height-this.view.height;return new h(e=e>=0?e:0,i=i>=0?i:0,0)},i.scrollToPercentHorizontal=function(t,e,i){var o=this._calculateMovePercentDelta({anchor:new D(t,0),applyToHorizontal:!0,applyToVertical:!1});e?this._startAutoScroll(o,e,!1!==i):this._moveContent(o)},i.scrollTo=function(t,e,i){var o=this._calculateMovePercentDelta({anchor:new D(t),applyToHorizontal:!0,applyToVertical:!0});e?this._startAutoScroll(o,e,i):this._moveContent(o)},i.scrollToPercentVertical=function(t,e,i){var o=this._calculateMovePercentDelta({anchor:new D(0,t),applyToHorizontal:!1,applyToVertical:!0});e?this._startAutoScroll(o,e,i):this._moveContent(o)},i.stopAutoScroll=function(){this._autoScrolling=!1,this._autoScrollAccumulatedTime=this._autoScrollTotalTime},i.setContentPosition=function(t){if(this._content){var e=this.getContentPosition();Math.abs(t.x-e.x)<1e-4&&Math.abs(t.y-e.y)<1e-4||(this._content.setPosition(t),this._outOfBoundaryAmountDirty=!0)}},i.getContentPosition=function(){return this._content?(this._contentPos.set(this._content.position),this._contentPos):Ga},i.isScrolling=function(){return this._scrolling},i.isAutoScrolling=function(){return this._autoScrolling},i.getScrollEndedEventTiming=function(){return 1e-4},i.start=function(){this._calculateBoundary(),this._content&&St.once(Et.EVENT_BEFORE_DRAW,this._adjustContentOutOfBoundary,this)},i.onEnable=function(){this._registerEvent(),this._content&&(this._content.on(X.EventType.SIZE_CHANGED,this._calculateBoundary,this),this._content.on(X.EventType.TRANSFORM_CHANGED,this._scaleChanged,this),this.view&&(this.view.node.on(X.EventType.TRANSFORM_CHANGED,this._scaleChanged,this),this.view.node.on(X.EventType.SIZE_CHANGED,this._calculateBoundary,this))),this._calculateBoundary(),this._updateScrollBarState()},i.update=function(t){this._autoScrolling&&this._processAutoScrolling(t)},i.onDisable=function(){this._unregisterEvent(),this._content&&(this._content.off(X.EventType.SIZE_CHANGED,this._calculateBoundary,this),this._content.off(X.EventType.TRANSFORM_CHANGED,this._scaleChanged,this),this.view&&(this.view.node.off(X.EventType.TRANSFORM_CHANGED,this._scaleChanged,this),this.view.node.off(X.EventType.SIZE_CHANGED,this._calculateBoundary,this))),this._hideScrollBar(),this.stopAutoScroll()},i._registerEvent=function(){this.node.on(X.EventType.TOUCH_START,this._onTouchBegan,this,!0),this.node.on(X.EventType.TOUCH_MOVE,this._onTouchMoved,this,!0),this.node.on(X.EventType.TOUCH_END,this._onTouchEnded,this,!0),this.node.on(X.EventType.TOUCH_CANCEL,this._onTouchCancelled,this,!0),this.node.on(X.EventType.MOUSE_WHEEL,this._onMouseWheel,this,!0)},i._unregisterEvent=function(){this.node.off(X.EventType.TOUCH_START,this._onTouchBegan,this,!0),this.node.off(X.EventType.TOUCH_MOVE,this._onTouchMoved,this,!0),this.node.off(X.EventType.TOUCH_END,this._onTouchEnded,this,!0),this.node.off(X.EventType.TOUCH_CANCEL,this._onTouchCancelled,this,!0),this.node.off(X.EventType.MOUSE_WHEEL,this._onMouseWheel,this,!0)},i._onMouseWheel=function(t,e){if(this.enabledInHierarchy&&!this._hasNestedViewGroup(t,e)){var i=new h,o=t.getScrollY();this.vertical?i.set(0,-.1*o,0):this.horizontal&&i.set(-.1*o,0,0),this._mouseWheelEventElapsedTime=0,this._processDeltaMove(i),this._stopMouseWheel||(this._handlePressLogic(),this.schedule(this._checkMouseWheel,1/60,NaN,0),this._stopMouseWheel=!0),this._stopPropagationIfTargetIsMe(t)}},i._onTouchBegan=function(t,e){this.enabledInHierarchy&&this._content&&(this._hasNestedViewGroup(t,e)||(this._handlePressLogic(),this._touchMoved=!1,this._stopPropagationIfTargetIsMe(t)))},i._onTouchMoved=function(t,e){if(this.enabledInHierarchy&&this._content&&!this._hasNestedViewGroup(t,e)){var i=t.touch;if(this._handleMoveLogic(i),this.cancelInnerEvents){var o=i.getUILocation(Xa);if(o.subtract(i.getUIStartLocation(Ya)),o.length()>7&&!this._touchMoved&&t.target!==this.node){var n=new gt(t.getTouches(),t.bubbles);n.type=X.EventType.TOUCH_CANCEL,n.touch=t.touch,n.simulate=!0,t.target.dispatchEvent(n),this._touchMoved=!0}this._stopPropagationIfTargetIsMe(t)}}},i._onTouchEnded=function(t,e){if(this.enabledInHierarchy&&this._content&&t&&!this._hasNestedViewGroup(t,e)){this._dispatchEvent(Ua.TOUCH_UP);var i=t.touch;this._handleReleaseLogic(i),this._touchMoved?t.propagationStopped=!0:this._stopPropagationIfTargetIsMe(t)}},i._onTouchCancelled=function(t,e){if(this.enabledInHierarchy&&this._content&&!this._hasNestedViewGroup(t,e)){if(t&&!t.simulate){var i=t.touch;this._handleReleaseLogic(i)}this._stopPropagationIfTargetIsMe(t)}},i._calculateBoundary=function(){if(this._content&&this.view){var t=this._content.getComponent(Wn);t&&t.enabledInHierarchy&&t.updateLayout();var e=this.view,i=e.width*e.anchorX,o=e.height*e.anchorY;this._leftBoundary=-i,this._bottomBoundary=-o,this._rightBoundary=this._leftBoundary+e.width,this._topBoundary=this._bottomBoundary+e.height,this._moveContentToTopLeft(e.contentSize)}},i._hasNestedViewGroup=function(t,e){if(t&&t.eventPhase===V.CAPTURING_PHASE){if(e)for(var i,o=k(e);!(i=o()).done;){var n=i.value;if(this.node===n)return!(!t.target||!t.target.getComponent(Va));if(n.getComponent(Va))return!0}return!1}},i._startInertiaScroll=function(t){var e=new h(t);e.multiplyScalar(.7),this._startAttenuatingAutoScroll(e,t)},i._calculateAttenuatedFactor=function(t){return this.brake<=0?1-this.brake:(1-this.brake)*(1/(1+14e-6*t+t*t*8e-9))},i._startAttenuatingAutoScroll=function(t,e){var i=new h(t);if(i.normalize(),this._content&&this.view){var o=this._content._uiProps.uiTransformComp.contentSize,n=this.view.contentSize,r=o.width-n.width,s=o.height-n.height,a=this._calculateAttenuatedFactor(r),l=this._calculateAttenuatedFactor(s);i.x=i.x*r*(1-this.brake)*a,i.y=i.y*s*l*(1-this.brake),i.z=0}var c=t.length(),u=i.length()/c;if(i.add(t),this.brake>0&&u>7){u=Math.sqrt(u);var _=new h(t);_.multiplyScalar(u),i.set(_),i.add(t)}var p=this._calculateAutoScrollTimeByInitialSpeed(e.length());this.brake>0&&u>3&&(p*=u=3),0===this.brake&&u>1&&(p*=u),this._startAutoScroll(i,p,!0)},i._calculateAutoScrollTimeByInitialSpeed=function(t){return Math.sqrt(Math.sqrt(t/5))},i._startAutoScroll=function(t,e,i){void 0===i&&(i=!1);var o=this._flattenVectorByDirection(t);this._autoScrolling=!0,this._autoScrollTargetDelta=o,this._autoScrollAttenuate=i,h.copy(this._autoScrollStartPosition,this.getContentPosition()),this._autoScrollTotalTime=e,this._autoScrollAccumulatedTime=0,this._autoScrollBraking=!1,this._isScrollEndedWithThresholdEventFired=!1,this._autoScrollBrakingStartPosition=new h,this._getHowMuchOutOfBoundary().equals(Ga,1e-4)||(this._autoScrollCurrentlyOutOfBoundary=!0)},i._calculateTouchMoveVelocity=function(){var t=0;if((t=this._touchMoveTimeDeltas.reduce((function(t,e){return t+e}),t))<=0||t>=.5)return new h;var e=new h;return e=this._touchMoveDisplacements.reduce((function(t,e){return t.add(e),t}),e),new h(e.x*(1-this.brake)/t,e.y*(1-this.brake)/t,0)},i._flattenVectorByDirection=function(t){var e=t;return e.x=this.horizontal?e.x:0,e.y=this.vertical?e.y:0,e},i._moveContent=function(t,e){var i=this._flattenVectorByDirection(t);Wa.set(this.getContentPosition()),Wa.add(i),Wa.set(1e-4*Math.floor(1e4*Wa.x),1e-4*Math.floor(1e4*Wa.y),Wa.z),this.setContentPosition(Wa);var o=this._getHowMuchOutOfBoundary();this._updateScrollBar(o),this.elastic&&e&&this._startBounceBackIfNeeded()},i._getContentLeftBoundary=function(){if(!this._content)return-1;var t=this.getContentPosition(),e=this._content._uiProps.uiTransformComp;return t.x-e.anchorX*e.width},i._getContentRightBoundary=function(){if(!this._content)return-1;var t=this._content._uiProps.uiTransformComp;return this._getContentLeftBoundary()+t.width},i._getContentTopBoundary=function(){if(!this._content)return-1;var t=this._content._uiProps.uiTransformComp;return this._getContentBottomBoundary()+t.height},i._getContentBottomBoundary=function(){if(!this._content)return-1;var t=this.getContentPosition(),e=this._content._uiProps.uiTransformComp;return t.y-e.anchorY*e.height},i._getHowMuchOutOfBoundary=function(t){if((t=t||new h).equals(Ga,1e-4)&&!this._outOfBoundaryAmountDirty)return this._outOfBoundaryAmount;var e=new h;return this._getContentLeftBoundary()+t.x>this._leftBoundary?e.x=this._leftBoundary-(this._getContentLeftBoundary()+t.x):this._getContentRightBoundary()+t.x<this._rightBoundary&&(e.x=this._rightBoundary-(this._getContentRightBoundary()+t.x)),this._getContentTopBoundary()+t.y<this._topBoundary?e.y=this._topBoundary-(this._getContentTopBoundary()+t.y):this._getContentBottomBoundary()+t.y>this._bottomBoundary&&(e.y=this._bottomBoundary-(this._getContentBottomBoundary()+t.y)),t.equals(Ga,1e-4)&&(this._outOfBoundaryAmount=e,this._outOfBoundaryAmountDirty=!1),this._clampDelta(e)},i._updateScrollBar=function(t){this._horizontalScrollBar&&this._horizontalScrollBar.onScroll(t),this.verticalScrollBar&&this.verticalScrollBar.onScroll(t)},i._onScrollBarTouchBegan=function(){this._horizontalScrollBar&&this._horizontalScrollBar.onTouchBegan(),this.verticalScrollBar&&this.verticalScrollBar.onTouchBegan()},i._onScrollBarTouchEnded=function(){this._horizontalScrollBar&&this._horizontalScrollBar.onTouchEnded(),this.verticalScrollBar&&this.verticalScrollBar.onTouchEnded()},i._dispatchEvent=function(t){if(t===Ua.SCROLL_ENDED)this._scrollEventEmitMask=0;else if(t===Ua.SCROLL_TO_TOP||t===Ua.SCROLL_TO_BOTTOM||t===Ua.SCROLL_TO_LEFT||t===Ua.SCROLL_TO_RIGHT){var e=1<<$a[t];if(this._scrollEventEmitMask&e)return;this._scrollEventEmitMask|=e}vt.emitEvents(this.scrollEvents,this,$a[t]),this.node.emit(t,this)},i._adjustContentOutOfBoundary=function(){if(this._content&&(this._outOfBoundaryAmountDirty=!0,this._isOutOfBoundary())){var t=this._getHowMuchOutOfBoundary();Wa.set(this.getContentPosition()),Wa.add(t),this._content.setPosition(Wa),this._updateScrollBar(Ga)}},i._hideScrollBar=function(){this._horizontalScrollBar&&this._horizontalScrollBar.hide(),this._verticalScrollBar&&this._verticalScrollBar.hide()},i._updateScrollBarState=function(){if(this._content&&this.view){var t=this.view,e=this._content._uiProps.uiTransformComp;this.verticalScrollBar&&(e.height<t.height?this.verticalScrollBar.hide():this.verticalScrollBar.show()),this.horizontalScrollBar&&(e.width<t.width?this.horizontalScrollBar.hide():this.horizontalScrollBar.show())}},i._stopPropagationIfTargetIsMe=function(t){t.eventPhase===V.AT_TARGET&&t.target===this.node&&(t.propagationStopped=!0)},i._processDeltaMove=function(t){this._scrollChildren(t),this._gatherTouchMove(t)},i._handleMoveLogic=function(t){this._deltaPos.set(this._getLocalAxisAlignDelta(t)),this._processDeltaMove(this._deltaPos)},i._handleReleaseLogic=function(t){this._deltaPos.set(this._getLocalAxisAlignDelta(t)),this._gatherTouchMove(this._deltaPos),this._processInertiaScroll(),this._scrolling&&(this._scrolling=!1,this._autoScrolling||this._dispatchEvent(Ua.SCROLL_ENDED))},i._getLocalAxisAlignDelta=function(t){var e=this.node._uiProps.uiTransformComp,i=new h;return e&&(t.getUILocation(Xa),t.getUIPreviousLocation(Ya),Wa.set(Xa.x,Xa.y,0),ja.set(Ya.x,Ya.y,0),e.convertToNodeSpaceAR(Wa,Wa),e.convertToNodeSpaceAR(ja,ja),h.subtract(i,Wa,ja)),i},i._scrollChildren=function(t){var e,i,o=t=this._clampDelta(t);if(this.elastic&&(e=this._getHowMuchOutOfBoundary(),o.x*=0===e.x?1:.5,o.y*=0===e.y?1:.5),this.elastic||(e=this._getHowMuchOutOfBoundary(o),o.add(e)),this._content){var n=this._content._uiProps.uiTransformComp,r=n.anchorX,s=n.anchorY,a=n.width,h=n.height,l=this._content.position||Ga;o.y>0?l.y-s*h+o.y>=this._bottomBoundary&&(i=Ua.SCROLL_TO_BOTTOM):o.y<0&&l.y-s*h+h+o.y<=this._topBoundary&&(i=Ua.SCROLL_TO_TOP),o.x<0?l.x-r*a+a+o.x<=this._rightBoundary&&(i=Ua.SCROLL_TO_RIGHT):o.x>0&&l.x-r*a+o.x>=this._leftBoundary&&(i=Ua.SCROLL_TO_LEFT)}this._moveContent(o,!1),0===o.x&&0===o.y||(this._scrolling||(this._scrolling=!0,this._dispatchEvent(Ua.SCROLL_BEGAN)),this._dispatchEvent(Ua.SCROLLING)),i&&i.length>0&&this._dispatchEvent(i)},i._handlePressLogic=function(){this._autoScrolling&&this._dispatchEvent(Ua.SCROLL_ENDED),this._autoScrolling=!1,this._isBouncing=!1,this._touchMovePreviousTimestamp=Za(),this._touchMoveDisplacements.length=0,this._touchMoveTimeDeltas.length=0,this._onScrollBarTouchBegan()},i._clampDelta=function(t){if(this._content&&this.view){var e=this.view.contentSize,i=this._content._uiProps.uiTransformComp;i.width<e.width&&(t.x=0),i.height<e.height&&(t.y=0)}return t},i._gatherTouchMove=function(t){var e=t.clone();for(this._clampDelta(e);this._touchMoveDisplacements.length>=5;)this._touchMoveDisplacements.shift(),this._touchMoveTimeDeltas.shift();this._touchMoveDisplacements.push(e);var i=Za();this._touchMoveTimeDeltas.push((i-this._touchMovePreviousTimestamp)/1e3),this._touchMovePreviousTimestamp=i},i._startBounceBackIfNeeded=function(){if(!this.elastic)return!1;var t=this._getHowMuchOutOfBoundary();if((t=this._clampDelta(t)).equals(Ga,1e-4))return!1;var e=Math.max(this.bounceDuration,0);return this._startAutoScroll(t,e,!0),this._isBouncing||(t.y>0&&this._dispatchEvent(Ua.BOUNCE_TOP),t.y<0&&this._dispatchEvent(Ua.BOUNCE_BOTTOM),t.x>0&&this._dispatchEvent(Ua.BOUNCE_RIGHT),t.x<0&&this._dispatchEvent(Ua.BOUNCE_LEFT),this._isBouncing=!0),!0},i._processInertiaScroll=function(){if(!this._startBounceBackIfNeeded()&&this.inertia){var t=this._calculateTouchMoveVelocity();!t.equals(Wa,1e-4)&&this.brake<1&&this._startInertiaScroll(t)}this._onScrollBarTouchEnded()},i._isOutOfBoundary=function(){return!this._getHowMuchOutOfBoundary().equals(Ga,1e-4)},i._isNecessaryAutoScrollBrake=function(){if(this._autoScrollBraking)return!0;if(this._isOutOfBoundary()){if(!this._autoScrollCurrentlyOutOfBoundary)return this._autoScrollCurrentlyOutOfBoundary=!0,this._autoScrollBraking=!0,this._autoScrollBrakingStartPosition=this.getContentPosition(),!0}else this._autoScrollCurrentlyOutOfBoundary=!1;return!1},i._processAutoScrolling=function(t){var e=this._isNecessaryAutoScrollBrake(),i=e?.05:1;this._autoScrollAccumulatedTime+=t*(1/i);var o,n=Math.min(1,this._autoScrollAccumulatedTime/this._autoScrollTotalTime);this._autoScrollAttenuate&&(o=n,n=(o-=1)*o*o*o*o+1);var r=new h(this._autoScrollTargetDelta);r.multiplyScalar(n);var s=new h(this._autoScrollStartPosition);s.add(r);var a=Math.abs(n-1)<=1e-4;if(Math.abs(n-1)<=this.getScrollEndedEventTiming()&&!this._isScrollEndedWithThresholdEventFired&&(this._dispatchEvent(Ua.SCROLL_ENG_WITH_THRESHOLD),this._isScrollEndedWithThresholdEventFired=!0),this.elastic){var l=new h(s);l.subtract(this._autoScrollBrakingStartPosition),e&&l.multiplyScalar(i),s.set(this._autoScrollBrakingStartPosition),s.add(l)}else{var c=new h(s);c.subtract(this.getContentPosition());var u=this._getHowMuchOutOfBoundary(c);u.equals(Ga,1e-4)||(s.add(u),a=!0)}a&&(this._autoScrolling=!1);var _=new h(s);_.subtract(this.getContentPosition()),this._moveContent(this._clampDelta(_),a),this._dispatchEvent(Ua.SCROLLING),this._autoScrolling||(this._isBouncing=!1,this._scrolling=!1,this._dispatchEvent(Ua.SCROLL_ENDED))},i._checkMouseWheel=function(t){if(!this._getHowMuchOutOfBoundary().equals(Ga,1e-4))return this._processInertiaScroll(),this.unschedule(this._checkMouseWheel),this._dispatchEvent(Ua.SCROLL_ENDED),void(this._stopMouseWheel=!1);this._mouseWheelEventElapsedTime+=t,this._mouseWheelEventElapsedTime>.1&&(this._onScrollBarTouchEnded(),this.unschedule(this._checkMouseWheel),this._dispatchEvent(Ua.SCROLL_ENDED),this._stopMouseWheel=!1)},i._calculateMovePercentDelta=function(t){var e=t.anchor,i=t.applyToHorizontal,o=t.applyToVertical;this._calculateBoundary(),e.clampf(new D(0,0),new D(1,1));var n=this._getContentBottomBoundary()-this._bottomBoundary;n=-n;var r=this._getContentLeftBoundary()-this._leftBoundary;r=-r;var s=new h;if(this._content&&this.view){var a=0,l=this._content._uiProps.uiTransformComp.contentSize,c=this.view.contentSize;i&&(a=l.width-c.width,s.x=r-a*e.x),o&&(a=l.height-c.height,s.y=n-a*e.y)}return s},i._moveContentToTopLeft=function(t){var e=this._getContentBottomBoundary()-this._bottomBoundary;e=-e;var i=new h,o=0,n=this._getContentLeftBoundary()-this._leftBoundary;if(n=-n,this._content){var r=this._content._uiProps.uiTransformComp.contentSize;r.height<t.height&&(o=r.height-t.height,i.y=e-o),r.width<t.width&&(o=r.width-t.width,i.x=n)}this._updateScrollBarState(),this._moveContent(i),this._adjustContentOutOfBoundary()},i._scaleChanged=function(t){t===$.SCALE&&this._calculateBoundary()},l(e,[{key:"content",get:function(){return this._content},set:function(t){if(this._content!==t){var e=t&&t.parent&&t.parent._uiProps.uiTransformComp;!t||t&&e?(this._content=t,this._calculateBoundary()):U(4302)}}},{key:"horizontalScrollBar",get:function(){return this._horizontalScrollBar},set:function(t){this._horizontalScrollBar!==t&&(this._horizontalScrollBar=t,this._horizontalScrollBar&&(this._horizontalScrollBar.setScrollView(this),this._updateScrollBar(Ga)))}},{key:"verticalScrollBar",get:function(){return this._verticalScrollBar},set:function(t){this._verticalScrollBar!==t&&(this._verticalScrollBar=t,this._verticalScrollBar&&(this._verticalScrollBar.setScrollView(this),this._updateScrollBar(Ga)))}},{key:"view",get:function(){var t=this._content&&this._content.parent;return t?t._uiProps.uiTransformComp:null}}]),e}(Va),Na.EventType=Ua,La=c((wa=ka).prototype,"bounceDuration",[v,Ks,Qs,Js],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Aa=c(wa.prototype,"brake",[v,ta,ea,ia],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),Da=c(wa.prototype,"elastic",[v,oa,na],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Pa=c(wa.prototype,"inertia",[v,ra,sa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),c(wa.prototype,"content",[aa,ha,la],Object.getOwnPropertyDescriptor(wa.prototype,"content"),wa.prototype),xa=c(wa.prototype,"horizontal",[v,ca,ua],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),c(wa.prototype,"horizontalScrollBar",[_a,pa,da],Object.getOwnPropertyDescriptor(wa.prototype,"horizontalScrollBar"),wa.prototype),Ia=c(wa.prototype,"vertical",[v,fa,ga],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),c(wa.prototype,"verticalScrollBar",[ya,ma,Ta],Object.getOwnPropertyDescriptor(wa.prototype,"verticalScrollBar"),wa.prototype),za=c(wa.prototype,"cancelInnerEvents",[v,va,ba],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Ra=c(wa.prototype,"scrollEvents",[Sa,v,Ca,Ea],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ba=c(wa.prototype,"_content",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ma=c(wa.prototype,"_horizontalScrollBar",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ha=c(wa.prototype,"_verticalScrollBar",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Oa=wa))||Oa)||Oa)||Oa)||Oa)||Oa)),kh=new h;function Fh(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return Object.assign.apply(Object,[{}].concat(e))}!function(t){t[t.Horizontal=0]="Horizontal",t[t.Vertical=1]="Vertical"}(yh||(yh={})),i(yh),t("e",(qa=o("cc.Slider"),Ka=u(),Qa=q(110),Ja=_(),th=K(Q),eh=n(Xt),ih=d(),oh=n(yh),nh=d(),rh=z(),sh=d(),ah=n([vt]),hh=d(),qa(lh=Ka(lh=Qa(lh=Ja(lh=th((gh=fh=function(t){function e(){for(var e,i=arguments.length,o=new Array(i),n=0;n<i;n++)o[n]=arguments[n];return e=t.call.apply(t,[this].concat(o))||this,y(e,"slideEvents",uh,m(e)),y(e,"_handle",_h,m(e)),y(e,"_direction",ph,m(e)),y(e,"_progress",dh,m(e)),e._offset=new h,e._dragging=!1,e._touchHandle=!1,e._handleLocalPos=new h,e._touchPos=new h,e}s(e,t);var i=e.prototype;return i.__preload=function(){this._updateHandlePosition()},i.onEnable=function(){this._updateHandlePosition(),this.node.on(Z.TOUCH_START,this._onTouchBegan,this),this.node.on(Z.TOUCH_MOVE,this._onTouchMoved,this),this.node.on(Z.TOUCH_END,this._onTouchEnded,this),this.node.on(Z.TOUCH_CANCEL,this._onTouchCancelled,this),this._handle&&this._handle.isValid&&(this._handle.node.on(Z.TOUCH_START,this._onHandleDragStart,this),this._handle.node.on(Z.TOUCH_MOVE,this._onTouchMoved,this),this._handle.node.on(Z.TOUCH_END,this._onTouchEnded,this))},i.onDisable=function(){this.node.off(Z.TOUCH_START,this._onTouchBegan,this),this.node.off(Z.TOUCH_MOVE,this._onTouchMoved,this),this.node.off(Z.TOUCH_END,this._onTouchEnded,this),this.node.off(Z.TOUCH_CANCEL,this._onTouchCancelled,this),this._handle&&this._handle.isValid&&(this._handle.node.off(Z.TOUCH_START,this._onHandleDragStart,this),this._handle.node.off(Z.TOUCH_MOVE,this._onTouchMoved,this),this._handle.node.off(Z.TOUCH_END,this._onTouchEnded,this))},i._onHandleDragStart=function(t){if(t&&this._handle&&this._handle.node._uiProps.uiTransformComp){this._dragging=!0,this._touchHandle=!0;var e=t.touch.getUILocation();h.set(this._touchPos,e.x,e.y,0),this._handle.node._uiProps.uiTransformComp.convertToNodeSpaceAR(this._touchPos,this._offset),t.propagationStopped=!0}},i._onTouchBegan=function(t){this._handle&&t&&(this._dragging=!0,this._touchHandle||this._handleSliderLogic(t.touch),t.propagationStopped=!0)},i._onTouchMoved=function(t){this._dragging&&t&&(this._handleSliderLogic(t.touch),t.propagationStopped=!0)},i._onTouchEnded=function(t){this._dragging=!1,this._touchHandle=!1,this._offset=new h,t&&(t.propagationStopped=!0)},i._onTouchCancelled=function(t){this._dragging=!1,t&&(t.propagationStopped=!0)},i._handleSliderLogic=function(t){this._updateProgress(t),this._emitSlideEvent()},i._emitSlideEvent=function(){vt.emitEvents(this.slideEvents,this),this.node.emit("slide",this)},i._updateProgress=function(t){if(this._handle&&t){var e=t.getUILocation();h.set(this._touchPos,e.x,e.y,0);var i=this.node._uiProps.uiTransformComp,o=i.convertToNodeSpaceAR(this._touchPos,kh);this.direction===yh.Horizontal?this.progress=M(.5+(o.x-this._offset.x)/i.width):this.progress=M(.5+(o.y-this._offset.y)/i.height)}},i._updateHandlePosition=function(){if(this._handle){this._handleLocalPos.set(this._handle.node.getPosition());var t=this.node._uiProps.uiTransformComp;this._direction===yh.Horizontal?this._handleLocalPos.x=-t.width*t.anchorX+this.progress*t.width:this._handleLocalPos.y=-t.height*t.anchorY+this.progress*t.height,this._handle.node.setPosition(this._handleLocalPos)}},i._changeLayout=function(){var t=this.node._uiProps.uiTransformComp,e=t.contentSize;if(t.setContentSize(e.height,e.width),this._handle){var i=this._handle.node.position;this._direction===yh.Horizontal?this._handle.node.setPosition(i.x,0,i.z):this._handle.node.setPosition(0,i.y,i.z),this._updateHandlePosition()}},l(e,[{key:"handle",get:function(){return this._handle},set:function(t){this._handle!==t&&(this._handle=t)}},{key:"direction",get:function(){return this._direction},set:function(t){this._direction!==t&&(this._direction=t,this._changeLayout())}},{key:"progress",get:function(){return this._progress},set:function(t){this._progress!==t&&(this._progress=t,this._updateHandlePosition())}}]),e}(T),fh.Direction=yh,c((ch=gh).prototype,"handle",[eh,ih],Object.getOwnPropertyDescriptor(ch.prototype,"handle"),ch.prototype),c(ch.prototype,"direction",[oh,nh],Object.getOwnPropertyDescriptor(ch.prototype,"direction"),ch.prototype),c(ch.prototype,"progress",[P,rh,sh],Object.getOwnPropertyDescriptor(ch.prototype,"progress"),ch.prototype),uh=c(ch.prototype,"slideEvents",[ah,v,hh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),_h=c(ch.prototype,"_handle",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ph=c(ch.prototype,"_direction",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return yh.Horizontal}}),dh=c(ch.prototype,"_progress",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.1}}),lh=ch))||lh)||lh)||lh)||lh)||lh)),function(t){t.TOGGLE="toggle"}(Hh||(Hh={})),t("T",(mh=o("cc.Toggle"),Th=u(),vh=q(110),bh=_(),Sh=K(Q),Ch=p(),Eh=d(),Oh=n(Xt),wh=p(),Lh=d(),Ah=n([vt]),Dh=d(),mh(Ph=Th(Ph=vh(Ph=bh(Ph=Sh((Mh=Bh=function(t){function e(){for(var e,i=arguments.length,o=new Array(i),n=0;n<i;n++)o[n]=arguments[n];return e=t.call.apply(t,[this].concat(o))||this,y(e,"checkEvents",Ih,m(e)),y(e,"_isChecked",zh,m(e)),y(e,"_checkMark",Rh,m(e)),e}s(e,t);var i=e.prototype;return i._internalToggle=function(){this.isChecked=!this.isChecked},i._set=function(t,e){if(void 0===e&&(e=!0),this._isChecked!=t){this._isChecked=t;var i=this._toggleContainer;i&&i.enabled&&this.enabled&&(t||!i.anyTogglesChecked()&&!i.allowSwitchOff)&&(this._isChecked=!0,i.notifyToggleCheck(this,e)),this.playEffect(),e&&this._emitToggleEvents()}},i.playEffect=function(){this._checkMark&&(this._checkMark.node.active=this._isChecked)},i.setIsCheckedWithoutNotify=function(t){this._set(t,!1)},i.onEnable=function(){t.prototype.onEnable.call(this),this.playEffect(),this.node.on(e.EventType.CLICK,this._internalToggle,this)},i.onDisable=function(){t.prototype.onDisable.call(this),this.node.off(e.EventType.CLICK,this._internalToggle,this)},i.OnDestroy=function(){var t=this._toggleContainer;t&&t.ensureValidState()},i._emitToggleEvents=function(){this.node.emit(e.EventType.TOGGLE,this),this.checkEvents&&vt.emitEvents(this.checkEvents,this)},l(e,[{key:"isChecked",get:function(){return this._isChecked},set:function(t){this._set(t)}},{key:"checkMark",get:function(){return this._checkMark},set:function(t){this._checkMark!==t&&(this._checkMark=t)}},{key:"_resizeToTarget",set:function(t){t&&this._resizeNodeToTargetNode()}},{key:"_toggleContainer",get:function(){var t=this.node.parent;return C.Node.isNode(t)?t.getComponent("cc.ToggleContainer"):null}}]),e}(ei),Bh.EventType=Fh(Hh,qe),c((xh=Mh).prototype,"isChecked",[Ch,Eh],Object.getOwnPropertyDescriptor(xh.prototype,"isChecked"),xh.prototype),c(xh.prototype,"checkMark",[Oh,wh,Lh],Object.getOwnPropertyDescriptor(xh.prototype,"checkMark"),xh.prototype),Ih=c(xh.prototype,"checkEvents",[Ah,v,Dh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),zh=c(xh.prototype,"_isChecked",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Rh=c(xh.prototype,"_checkMark",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ph=xh))||Ph)||Ph)||Ph)||Ph)||Ph)),t("f",(Vh=o("cc.ToggleContainer"),Uh=u(),Gh=q(110),Wh=_(),jh=d(),Xh=n([vt]),Yh=d(),Vh(Zh=Uh(Zh=Gh(Zh=Wh(Zh=r((Qh=function(t){function e(){for(var e,i=arguments.length,o=new Array(i),n=0;n<i;n++)o[n]=arguments[n];return e=t.call.apply(t,[this].concat(o))||this,y(e,"_allowSwitchOff",qh,m(e)),y(e,"checkEvents",Kh,m(e)),e}s(e,t);var i=e.prototype;return i.start=function(){this.ensureValidState()},i.activeToggles=function(){return this.toggleItems.filter((function(t){return t.isChecked}))},i.anyTogglesChecked=function(){return!!this.toggleItems.find((function(t){return t.isChecked}))},i.notifyToggleCheck=function(t,e){if(void 0===e&&(e=!0),this.enabledInHierarchy){for(var i=0;i<this.toggleItems.length;i++){var o=this.toggleItems[i];o!==t&&(e?o.isChecked=!1:o.setIsCheckedWithoutNotify(!1))}this.checkEvents&&C.Component.EventHandler.emitEvents(this.checkEvents,t)}},i.ensureValidState=function(){var t=this.toggleItems;if(!this._allowSwitchOff&&!this.anyTogglesChecked()&&0!==t.length){var e=t[0];e.isChecked=!0,this.notifyToggleCheck(e)}var i=this.activeToggles();if(i.length>1)for(var o=i[0],n=0;n<i.length;++n){var r=i[n];r!==o&&(r.isChecked=!1)}},l(e,[{key:"allowSwitchOff",get:function(){return this._allowSwitchOff},set:function(t){this._allowSwitchOff=t}},{key:"toggleItems",get:function(){return this.node.children.map((function(t){var e=t.getComponent("cc.Toggle");if(e&&e.enabled)return e})).filter(Boolean)}}]),e}(T),qh=c(($h=Qh).prototype,"_allowSwitchOff",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),c($h.prototype,"allowSwitchOff",[jh],Object.getOwnPropertyDescriptor($h.prototype,"allowSwitchOff"),$h.prototype),Kh=c($h.prototype,"checkEvents",[Xh,v,Yh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Zh=$h))||Zh)||Zh)||Zh)||Zh)||Zh)),t("U",o("cc.UIMeshRenderer")(Jh=u()(Jh=q(110)(Jh=_()(Jh=function(t){function e(){for(var e,i=arguments.length,o=new Array(i),n=0;n<i;n++)o[n]=arguments[n];return(e=t.call.apply(t,[this].concat(o))||this)._models=null,e._modelComponent=null,e}s(e,t);var i=e.prototype;return i.onLoad=function(){this.node._uiProps.uiTransformComp||this.node.addComponent("cc.UITransform"),this._modelComponent=this.getComponent("cc.RenderableComponent"),this._modelComponent?(this._modelComponent._sceneGetter=St.root.ui.getRenderSceneGetter(),this._models=this._modelComponent._collectModels()):console.warn("node '"+(this.node&&this.node.name)+"' doesn't have any renderable component")},i.onEnable=function(){t.prototype.onEnable.call(this),this._modelComponent&&this._modelComponent._attachToScene()},i.onDisable=function(){t.prototype.onDisable.call(this),this._modelComponent&&this._modelComponent._detachFromScene()},i.onDestroy=function(){t.prototype.onDestroy.call(this),this._modelComponent=this.getComponent("cc.RenderableComponent"),this._modelComponent&&(this._modelComponent._sceneGetter=null,C.isValid(this._modelComponent,!0)&&this._modelComponent._attachToScene(),this._models=null)},i.updateAssembler=function(t){if(this._models){for(var e,i=k(this._models);!(e=i()).done;){var o=e.value;t.commitModel.call(t,this,o,this._modelComponent.material)}return!0}return!1},i.update=function(){this._fitUIRenderQueue()},i._fitUIRenderQueue=function(){if(this._modelComponent)for(var t=this._modelComponent.sharedMaterials.length,e=0;e<t;e++){var i=this._modelComponent.getMaterialInstance(e);if(null!=i)for(var o=i.passes,n=o.length,r=0;r<n;r++){var s=o[r];s._priority=yt.MAX-11,s.blendState.targets[0].blend||i.overridePipelineStates({blendState:{targets:[{blend:!0}]}},r)}}},l(e,[{key:"modelComponent",get:function(){return this._modelComponent}}]),e}(Rt))||Jh)||Jh)||Jh)||Jh);var Vh,Uh,Gh,Wh,jh,Xh,Yh,Zh,$h,qh,Kh,Qh,Jh,tl,el,il,ol,nl,rl,sl,al,hl,ll,cl,ul,_l,pl,dl,fl,gl,yl,ml,Tl,vl=new e;!function(t){t[t.HORIZONTAL=0]="HORIZONTAL",t[t.VERTICAL=1]="VERTICAL"}(Tl||(Tl={})),i(Tl);var bl,Sl,Cl,El,Ol,wl,Ll,Al,Dl,Pl,xl,Il,zl,Rl,Bl,Ml,Hl,Nl,kl,Fl,Vl,Ul,Gl,Wl,jl,Xl,Yl,Zl,$l,ql,Kl,Ql,Jl,tc,ec,ic,oc,nc,rc,sc,ac,hc,lc,cc,uc,_c=t("h",(tl=o("cc.PageViewIndicator"),el=u(),il=q(110),ol=_(),nl=n(Y),rl=d(),sl=n(Tl),al=d(),hl=n(L),ll=d(),cl=d(),tl(ul=el(ul=il(ul=ol((ml=yl=function(t){function e(){for(var e,i=arguments.length,o=new Array(i),n=0;n<i;n++)o[n]=arguments[n];return e=t.call.apply(t,[this].concat(o))||this,y(e,"spacing",pl,m(e)),y(e,"_spriteFrame",dl,m(e)),y(e,"_direction",fl,m(e)),y(e,"_cellSize",gl,m(e)),e._layout=null,e._pageView=null,e._indicators=[],e}s(e,t);var i=e.prototype;return i.onLoad=function(){this._updateLayout()},i.setPageView=function(t){this._pageView=t,this._refresh()},i._updateLayout=function(){this._layout=this.getComponent(Wn),this._layout||(this._layout=this.addComponent(Wn));var t=this._layout;this.direction===Tl.HORIZONTAL?(t.type=Wn.Type.HORIZONTAL,t.spacingX=this.spacing):this.direction===Tl.VERTICAL&&(t.type=Wn.Type.VERTICAL,t.spacingY=this.spacing),t.resizeMode=Wn.ResizeMode.CONTAINER},i._createIndicator=function(){var t=new X,e=t.addComponent(Xt);return e.spriteFrame=this.spriteFrame,e.sizeMode=Xt.SizeMode.CUSTOM,t.parent=this.node,t._uiProps.uiTransformComp.setContentSize(this._cellSize),t},i._changedState=function(){var t=this._indicators;if(0!==t.length&&this._pageView){var e=this._pageView.curPageIdx;if(!(e>=t.length)){for(var i=0;i<t.length;++i){var o=t[i];if(o._uiProps.uiComp){var n=o._uiProps.uiComp;vl.set(n.color),vl.a=127.5,n.color=vl}}if(t[e]._uiProps.uiComp){var r=t[e]._uiProps.uiComp;vl.set(r.color),vl.a=255,r.color=vl}}}},i._refresh=function(){if(this._pageView){var t=this._indicators,e=this._pageView.getPages();if(e.length!==t.length){var i=0;if(e.length>t.length)for(i=0;i<e.length;++i)t[i]||(t[i]=this._createIndicator());else for(i=t.length-e.length;i>0;--i){var o=t[i-1];this.node.removeChild(o),t.splice(i-1,1)}this._layout&&this._layout.enabledInHierarchy&&this._layout.updateLayout(),this._changedState()}}},l(e,[{key:"spriteFrame",get:function(){return this._spriteFrame},set:function(t){this._spriteFrame!==t&&(this._spriteFrame=t)}},{key:"direction",get:function(){return this._direction},set:function(t){this._direction!==t&&(this._direction=t)}},{key:"cellSize",get:function(){return this._cellSize},set:function(t){this._cellSize!==t&&(this._cellSize=t)}}]),e}(T),yl.Direction=Tl,c((_l=ml).prototype,"spriteFrame",[nl,rl],Object.getOwnPropertyDescriptor(_l.prototype,"spriteFrame"),_l.prototype),c(_l.prototype,"direction",[sl,al],Object.getOwnPropertyDescriptor(_l.prototype,"direction"),_l.prototype),c(_l.prototype,"cellSize",[hl,ll],Object.getOwnPropertyDescriptor(_l.prototype,"cellSize"),_l.prototype),pl=c(_l.prototype,"spacing",[v,cl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),dl=c(_l.prototype,"_spriteFrame",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),fl=c(_l.prototype,"_direction",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Tl.HORIZONTAL}}),gl=c(_l.prototype,"_cellSize",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new L(20,20)}}),ul=_l))||ul)||ul)||ul)||ul)),pc=new D;!function(t){t[t.Unified=0]="Unified",t[t.Free=1]="Free"}(lc||(lc={})),i(lc),function(t){t[t.Horizontal=0]="Horizontal",t[t.Vertical=1]="Vertical"}(cc||(cc={})),i(cc),function(t){t.PAGE_TURNING="page-turning"}(uc||(uc={})),t("g",(bl=o("cc.PageView"),Sl=u(),Cl=q(110),El=_(),Ol=n(lc),wl=d(),Ll=n(cc),Al=d(),Dl=z(),Pl=d(),xl=z(),Il=d(),zl=n(_c),Rl=d(),Bl=d(),Ml=n(Fa),Hl=I(),Nl=n(Fa),kl=I(),Fl=I(),Vl=I(),Ul=I(),Gl=n([vt]),Wl=I(),jl=n([vt]),Xl=d(),bl(Yl=Sl(Yl=Cl(Yl=El((hc=ac=function(t){function e(){for(var e,i=arguments.length,o=new Array(i),n=0;n<i;n++)o[n]=arguments[n];return e=t.call.apply(t,[this].concat(o))||this,y(e,"autoPageTurningThreshold",$l,m(e)),y(e,"horizontal",ql,m(e)),y(e,"vertical",Kl,m(e)),y(e,"cancelInnerEvents",Ql,m(e)),y(e,"scrollEvents",Jl,m(e)),y(e,"pageTurningSpeed",tc,m(e)),y(e,"pageEvents",ec,m(e)),y(e,"_sizeMode",ic,m(e)),y(e,"_direction",oc,m(e)),y(e,"_scrollThreshold",nc,m(e)),y(e,"_pageTurningEventTiming",rc,m(e)),y(e,"_indicator",sc,m(e)),e._curPageIdx=0,e._lastPageIdx=0,e._pages=[],e._initContentPos=new h,e._scrollCenterOffsetX=[],e._scrollCenterOffsetY=[],e._touchBeganPosition=new h,e._touchEndPosition=new h,e}s(e,t);var i=e.prototype;return i.onEnable=function(){t.prototype.onEnable.call(this),this.node.on(Z.SIZE_CHANGED,this._updateAllPagesSize,this),this.node.on(e.EventType.SCROLL_ENG_WITH_THRESHOLD,this._dispatchPageTurningEvent,this)},i.onDisable=function(){t.prototype.onDisable.call(this),this.node.off(Z.SIZE_CHANGED,this._updateAllPagesSize,this),this.node.off(e.EventType.SCROLL_ENG_WITH_THRESHOLD,this._dispatchPageTurningEvent,this)},i.onLoad=function(){this._initPages(),this.indicator&&this.indicator.setPageView(this)},i.getCurrentPageIndex=function(){return this._curPageIdx},i.setCurrentPageIndex=function(t){this.scrollToPage(t,1)},i.getPages=function(){return this._pages},i.addPage=function(t){t&&-1===this._pages.indexOf(t)&&this.content&&(t._uiProps.uiTransformComp?(this.content.addChild(t),this._pages.push(t),this._updatePageView()):U(4301))},i.insertPage=function(t,e){if(!(e<0)&&t&&-1===this._pages.indexOf(t)&&this.content)if(e>=this._pages.length)this.addPage(t);else{if(!t._uiProps.uiTransformComp)return void U(4301);this._pages.splice(e,0,t),this.content.insertChild(t,e),this._updatePageView()}},i.removePage=function(t){if(t&&this.content){var e=this._pages.indexOf(t);-1!==e?this.removePageAtIndex(e):R(4300,t.name)}},i.removePageAtIndex=function(t){var e=this._pages;if(!(t<0||t>=e.length)){var i=e[t];i&&this.content&&(this.content.removeChild(i),e.splice(t,1),this._updatePageView())}},i.removeAllPages=function(){if(this.content){for(var t=this._pages,e=0,i=t.length;e<i;e++)this.content.removeChild(t[e]);this._pages.length=0,this._updatePageView()}},i.scrollToPage=function(t,e){void 0===e&&(e=.3),t<0||t>=this._pages.length||(this._curPageIdx=t,this.scrollToOffset(this._moveOffsetValue(t),e,!0),this.indicator&&this.indicator._changedState())},i.getScrollEndedEventTiming=function(){return this.pageTurningEventTiming},i._updatePageView=function(){if(this.content){var t=this.content.getComponent(Wn);t&&t.enabled&&t.updateLayout();var e=this._pages.length;this._curPageIdx>=e&&(this._curPageIdx=0===e?0:e-1,this._lastPageIdx=this._curPageIdx);for(var i=this._initContentPos,o=0;o<e;++o){var n=this._pages[o].position;this.direction===cc.Horizontal?this._scrollCenterOffsetX[o]=Math.abs(i.x+n.x):this._scrollCenterOffsetY[o]=Math.abs(i.y+n.y)}this.indicator&&this.indicator._refresh()}},i._updateAllPagesSize=function(){var t=this.view;if(this.content&&t&&this._sizeMode===lc.Unified)for(var e=this._pages,i=t.contentSize,o=0,n=e.length;o<n;o++)e[o]._uiProps.uiTransformComp.setContentSize(i)},i._handleReleaseLogic=function(){this._autoScrollToPage(),this._scrolling&&(this._scrolling=!1,this._autoScrolling||this._dispatchEvent(e.EventType.SCROLL_ENDED))},i._onTouchBegan=function(e,i){e.touch.getUILocation(pc),h.set(this._touchBeganPosition,pc.x,pc.y,0),t.prototype._onTouchBegan.call(this,e,i)},i._onTouchMoved=function(e,i){t.prototype._onTouchMoved.call(this,e,i)},i._onTouchEnded=function(e,i){e.touch.getUILocation(pc),h.set(this._touchEndPosition,pc.x,pc.y,0),t.prototype._onTouchEnded.call(this,e,i)},i._onTouchCancelled=function(e,i){e.touch.getUILocation(pc),h.set(this._touchEndPosition,pc.x,pc.y,0),t.prototype._onTouchCancelled.call(this,e,i)},i._onMouseWheel=function(){},i._syncScrollDirection=function(){this.horizontal=this.direction===cc.Horizontal,this.vertical=this.direction===cc.Vertical},i._syncSizeMode=function(){var t=this.view;if(this.content&&t){var e=this.content.getComponent(Wn);if(e){if(this._sizeMode===lc.Free&&this._pages.length>0){var i=this._pages[0]._uiProps.uiTransformComp,o=this._pages[this._pages.length-1]._uiProps.uiTransformComp;this.direction===cc.Horizontal?(e.paddingLeft=(t.width-i.width)/2,e.paddingRight=(t.width-o.width)/2):this.direction===cc.Vertical&&(e.paddingTop=(t.height-i.height)/2,e.paddingBottom=(t.height-o.height)/2)}e.updateLayout()}}},i._initPages=function(){if(this.content){this._initContentPos=this.content.position;for(var t=this.content.children,e=0;e<t.length;++e){var i=t[e];this._pages.indexOf(i)>=0||this._pages.push(i)}this._syncScrollDirection(),this._syncSizeMode(),this._updatePageView()}},i._dispatchPageTurningEvent=function(){this._lastPageIdx!==this._curPageIdx&&(this._lastPageIdx=this._curPageIdx,vt.emitEvents(this.pageEvents,this,uc.PAGE_TURNING),this.node.emit(uc.PAGE_TURNING,this))},i._isQuicklyScrollable=function(t){if(this.direction===cc.Horizontal){if(Math.abs(t.x)>this.autoPageTurningThreshold)return!0}else if(this.direction===cc.Vertical&&Math.abs(t.y)>this.autoPageTurningThreshold)return!0;return!1},i._moveOffsetValue=function(t){var e=new h;if(this._sizeMode===lc.Free)this.direction===cc.Horizontal?e.x=this._scrollCenterOffsetX[t]:this.direction===cc.Vertical&&(e.y=this._scrollCenterOffsetY[t]);else{var i=this.view;if(!i)return e;this.direction===cc.Horizontal?e.x=t*i.width:this.direction===cc.Vertical&&(e.y=t*i.height)}return e},i._getDragDirection=function(t){return this._direction===cc.Horizontal?0===t.x?0:t.x>0?1:-1:0===t.y?0:t.y<0?1:-1},i._isScrollable=function(t,e,i){if(this._sizeMode===lc.Free){var o=0,n=0;if(this.direction===cc.Horizontal)return o=this._scrollCenterOffsetX[e],n=this._scrollCenterOffsetX[i],Math.abs(t.x)>=Math.abs(o-n)*this.scrollThreshold;if(this.direction===cc.Vertical)return o=this._scrollCenterOffsetY[e],n=this._scrollCenterOffsetY[i],Math.abs(t.y)>=Math.abs(o-n)*this.scrollThreshold}else{var r=this.view;if(!r)return;if(this.direction===cc.Horizontal)return Math.abs(t.x)>=r.width*this.scrollThreshold;if(this.direction===cc.Vertical)return Math.abs(t.y)>=r.height*this.scrollThreshold}},i._autoScrollToPage=function(){if(this._startBounceBackIfNeeded()){var t=this._getHowMuchOutOfBoundary();((t=this._clampDelta(t)).x>0||t.y<0)&&(this._curPageIdx=0===this._pages.length?0:this._pages.length-1),(t.x<0||t.y>0)&&(this._curPageIdx=0),this.indicator&&this.indicator._changedState()}else{var e=new h;h.subtract(e,this._touchBeganPosition,this._touchEndPosition);var i=this._curPageIdx,o=i+this._getDragDirection(e),n=this.pageTurningSpeed*Math.abs(i-o);if(o<this._pages.length){if(this._isScrollable(e,i,o))return void this.scrollToPage(o,n);var r=this._calculateTouchMoveVelocity();if(this._isQuicklyScrollable(r))return void this.scrollToPage(o,n)}this.scrollToPage(i,n)}},l(e,[{key:"sizeMode",get:function(){return this._sizeMode},set:function(t){this._sizeMode!==t&&(this._sizeMode=t,this._syncSizeMode())}},{key:"direction",get:function(){return this._direction},set:function(t){this._direction!==t&&(this._direction=t,this._syncScrollDirection())}},{key:"scrollThreshold",get:function(){return this._scrollThreshold},set:function(t){this._scrollThreshold!==t&&(this._scrollThreshold=t)}},{key:"pageTurningEventTiming",get:function(){return this._pageTurningEventTiming},set:function(t){this._pageTurningEventTiming!==t&&(this._pageTurningEventTiming=t)}},{key:"indicator",get:function(){return this._indicator},set:function(t){this._indicator!==t&&(this._indicator=t,this.indicator&&this.indicator.setPageView(this))}},{key:"curPageIdx",get:function(){return this._curPageIdx}},{key:"verticalScrollBar",get:function(){return t.prototype.verticalScrollBar},set:function(t){this.verticalScrollBar=t}},{key:"horizontalScrollBar",get:function(){return t.prototype.horizontalScrollBar},set:function(t){this.horizontalScrollBar=t}}]),e}(Nh),ac.SizeMode=lc,ac.Direction=cc,ac.EventType=Fh(uc,Ua),c((Zl=hc).prototype,"sizeMode",[Ol,wl],Object.getOwnPropertyDescriptor(Zl.prototype,"sizeMode"),Zl.prototype),c(Zl.prototype,"direction",[Ll,Al],Object.getOwnPropertyDescriptor(Zl.prototype,"direction"),Zl.prototype),c(Zl.prototype,"scrollThreshold",[P,Dl,Pl],Object.getOwnPropertyDescriptor(Zl.prototype,"scrollThreshold"),Zl.prototype),c(Zl.prototype,"pageTurningEventTiming",[P,xl,Il],Object.getOwnPropertyDescriptor(Zl.prototype,"pageTurningEventTiming"),Zl.prototype),c(Zl.prototype,"indicator",[zl,Rl],Object.getOwnPropertyDescriptor(Zl.prototype,"indicator"),Zl.prototype),$l=c(Zl.prototype,"autoPageTurningThreshold",[v,Bl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),c(Zl.prototype,"verticalScrollBar",[Ml,x,Hl],Object.getOwnPropertyDescriptor(Zl.prototype,"verticalScrollBar"),Zl.prototype),c(Zl.prototype,"horizontalScrollBar",[Nl,x,kl],Object.getOwnPropertyDescriptor(Zl.prototype,"horizontalScrollBar"),Zl.prototype),ql=c(Zl.prototype,"horizontal",[x,v,Fl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Kl=c(Zl.prototype,"vertical",[x,v,Vl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Ql=c(Zl.prototype,"cancelInnerEvents",[x,v,Ul],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Jl=c(Zl.prototype,"scrollEvents",[Gl,v,x,Wl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),tc=c(Zl.prototype,"pageTurningSpeed",[v,G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.3}}),ec=c(Zl.prototype,"pageEvents",[jl,v,Xl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ic=c(Zl.prototype,"_sizeMode",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return lc.Unified}}),oc=c(Zl.prototype,"_direction",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return cc.Horizontal}}),nc=c(Zl.prototype,"_scrollThreshold",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),rc=c(Zl.prototype,"_pageTurningEventTiming",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.1}}),sc=c(Zl.prototype,"_indicator",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Yl=Zl))||Yl)||Yl)||Yl)||Yl)),t("i",(dc=o("cc.UIStaticBatch"),fc=u(),gc=_(),yc=q(110),mc=I(),Tc=I(),vc=I(),dc(bc=fc(bc=gc(bc=yc((Cc=function(t){function e(){for(var e,i=arguments.length,o=new Array(i),n=0;n<i;n++)o[n]=arguments[n];return(e=t.call.apply(t,[this].concat(o))||this)._init=!1,e._meshBuffer=null,e._dirty=!0,e._lastMeshBuffer=null,e._uiDrawBatchList=[],e}s(e,t);var i=e.prototype;return i.onLoad=function(){var t=this._getUI();if(t){var e=Bt,i=new Mt(t);i.initialize(e,this._arrivalMaxBuffer),this._meshBuffer=i}},i.onDestroy=function(){t.prototype.onDestroy.call(this),this._clearData(),this._meshBuffer&&(this._meshBuffer.destroy(),this._meshBuffer=null)},i.updateAssembler=function(t){this._dirty&&(t.finishMergeBatches(),this._lastMeshBuffer=t.currBufferBatch,t.currBufferBatch=this._meshBuffer,t.currStaticRoot=this),this._init&&(t.finishMergeBatches(),t.commitStaticBatch(this))},i.postUpdateAssembler=function(t){this._dirty&&(t.finishMergeBatches(),t.currBufferBatch=this._lastMeshBuffer,t.currStaticRoot=null,this._dirty=!1,this._init=!0,this.node._static=!0,this._meshBuffer.uploadBuffers())},i.markAsDirty=function(){this._getUI()&&(this.node._static=!1,this._dirty=!0,this._init=!1,this._clearData())},i._requireDrawBatch=function(){var t=new Ht;return t.isStatic=!0,this._uiDrawBatchList.push(t),t},i._clearData=function(){if(this._meshBuffer){this._meshBuffer.reset();for(var t=this._getUI(),e=0;e<this._uiDrawBatchList.length;e++)this._uiDrawBatchList[e].destroy(t)}this._uiDrawBatchList.length=0,this._init=!1},i._getUI=function(){return St.root&&St.root.ui?St.root.ui:(R(9301),null)},i._arrivalMaxBuffer=function(){R(9300)},l(e,[{key:"dstBlendFactor",get:function(){return this._dstBlendFactor},set:function(t){this._dstBlendFactor!==t&&(this._dstBlendFactor=t,this._updateBlendFunc())}},{key:"srcBlendFactor",get:function(){return this._srcBlendFactor},set:function(t){this._srcBlendFactor!==t&&(this._srcBlendFactor=t,this._updateBlendFunc())}},{key:"color",get:function(){return this._color},set:function(t){this._color!==t&&(this._color.set(t),this._updateColor(),this.markForUpdateRenderData())}},{key:"drawBatchList",get:function(){return this._uiDrawBatchList}}]),e}(bt),c((Sc=Cc).prototype,"dstBlendFactor",[x,mc],Object.getOwnPropertyDescriptor(Sc.prototype,"dstBlendFactor"),Sc.prototype),c(Sc.prototype,"srcBlendFactor",[x,Tc],Object.getOwnPropertyDescriptor(Sc.prototype,"srcBlendFactor"),Sc.prototype),c(Sc.prototype,"color",[x,vc],Object.getOwnPropertyDescriptor(Sc.prototype,"color"),Sc.prototype),bc=Sc))||bc)||bc)||bc)||bc)),t("j",o("cc.UIOpacity")(Ec=u()(Ec=q(110)(Ec=_()(Ec=r((Lc=function(t){function e(){for(var e,i=arguments.length,o=new Array(i),n=0;n<i;n++)o[n]=arguments[n];return e=t.call.apply(t,[this].concat(o))||this,y(e,"_opacity",wc,m(e)),e}s(e,t);var i=e.prototype;return i.onEnable=function(){this.node._uiProps.opacity=this._opacity/255},i.onDisable=function(){this.node._uiProps.opacity=1},l(e,[{key:"opacity",get:function(){return this._opacity},set:function(t){this._opacity!==t&&(t=W(t,0,255),this._opacity=t,this.node._uiProps.opacity=t/255)}}]),e}(T),c((Oc=Lc).prototype,"opacity",[G],Object.getOwnPropertyDescriptor(Oc.prototype,"opacity"),Oc.prototype),wc=c(Oc.prototype,"_opacity",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 255}}),Ec=Oc))||Ec)||Ec)||Ec)||Ec)||Ec);var dc,fc,gc,yc,mc,Tc,vc,bc,Sc,Cc,Ec,Oc,wc,Lc,Ac=new h,Dc=new D,Pc=new h,xc=new h(1,1,1);function Ic(t,e){var i,o=e.target,n=Pc,r=xc;o?Ft(t,i=o,n,r):i=t.parent;var s=Vt(i),a=i instanceof Gt||!i.getComponent(Q),l=a?Dc:i.getComponent(Q).anchorPoint,c=a;t.getPosition(Ac);var u=t._uiProps.uiTransformComp,_=Ac.x,p=Ac.y,d=u.anchorPoint,f=t.getScale();if(e.alignFlags&Ut.HORIZONTAL){var g=0,y=0,m=s.width;c?(g=et.left.x,y=et.right.x):y=(g=-l.x*m)+m,g+=e.isAbsoluteLeft?e.left:e.left*m,y-=e.isAbsoluteRight?e.right:e.right*m,o&&(g+=n.x,g*=r.x,y+=n.x,y*=r.x);var T=0,v=d.x,b=f.x;if(b<0&&(v=1-v,b=-b),e.isStretchWidth)T=y-g,0!==b&&(u.width=T/b),_=g+v*T;else if(T=u.width*b,e.isAlignHorizontalCenter){var S=e.isAbsoluteHorizontalCenter?e.horizontalCenter:e.horizontalCenter*m,C=(.5-l.x)*s.width;o&&(S*=r.x,C+=n.x,C*=r.x),_=C+(v-.5)*T+S}else _=e.isAlignLeft?g+v*T:y+(v-1)*T;e._lastSize.width=T}if(e.alignFlags&Ut.VERTICAL){var E=0,O=0,w=s.height;c?(O=et.bottom.y,E=et.top.y):E=(O=-l.y*w)+w,O+=e.isAbsoluteBottom?e.bottom:e.bottom*w,E-=e.isAbsoluteTop?e.top:e.top*w,o&&(O+=n.y,O*=r.y,E+=n.y,E*=r.y);var L=0,A=d.y,D=f.y;if(D<0&&(A=1-A,D=-D),e.isStretchHeight)L=E-O,0!==D&&(u.height=L/D),p=O+A*L;else if(L=u.height*D,e.isAlignVerticalCenter){var P=e.isAbsoluteVerticalCenter?e.verticalCenter:e.verticalCenter*w,x=(.5-l.y)*s.height;o&&(P*=r.y,x+=n.y,x*=r.y),p=x+(A-.5)*L+P}else p=e.isAlignBottom?O+A*L:E+(A-1)*L;e._lastSize.height=L}t.setPosition(_,p,Ac.z),h.set(e._lastPos,_,p,Ac.z)}function zc(){var t=St.getScene();if(t){if(Vc.isAligning=!0,Vc._nodesOrderDirty)Fc.length=0,function t(e){var i=e.getComponent(Nt);if(i)if(Ic(e,i),i.alignMode===kt.ONCE)i.enabled=!1;else{if(!C.isValid(e,!0))return;Fc.push(i)}for(var o,n=e.children,r=k(n);!(o=r()).done;){var s=o.value;s.active&&t(s)}}(t),Vc._nodesOrderDirty=!1;else{var e=null,i=Vc._activeWidgetsIterator;for(i.i=0;i.i<Fc.length;++i.i)(e=Fc[i.i])._dirty&&(Ic(e.node,e),e._dirty=!1)}Vc.isAligning=!1}}var Rc,Bc,Mc,Hc,Nc,kc,Fc=[],Vc=t("w",C._widgetManager={isAligning:!1,_nodesOrderDirty:!1,_activeWidgetsIterator:new j.MutableForwardIterator(Fc),animationState:null,init:function(){St.on(Et.EVENT_AFTER_UPDATE,zc);var t=this.onResized.bind(this);mt.instance.on("canvas-resize",t),window.addEventListener("orientationchange",t)},add:function(){this._nodesOrderDirty=!0},remove:function(t){this._activeWidgetsIterator.remove(t)},onResized:function(){var t=St.getScene();t&&this.refreshWidgetOnResized(t)},refreshWidgetOnResized:function(t){var e=X.isNode(t)&&t.getComponent(Nt);e&&e.enabled&&(e.alignMode===kt.ON_WINDOW_RESIZE||e.alignMode===kt.ALWAYS)&&e.setDirty();for(var i,o=t.children,n=k(o);!(i=n()).done;){var r=i.value;this.refreshWidgetOnResized(r)}},updateOffsetsToStayPut:function(t,e){function i(t,e){return Math.abs(t-e)>1e-10?e:t}var o=t.node,n=o.parent;if(n){var r=new h,s=new h(1,1,1);if(t.target&&(n=t.target,Ft(o,n,r,s)),!e)return;var a=n._uiProps&&n._uiProps.uiTransformComp,l=a?a.anchorPoint:Dc,c=o._uiProps.uiTransformComp,u=Vt(n),_=c.anchorPoint,p=o.getPosition(),d=Ut,f=o.getScale(),g=0;if(e&d.LEFT){var y=-l.x*u.width;y+=r.x,y*=s.x,g=p.x-_.x*c.width*f.x-y,t.isAbsoluteLeft||(g/=u.width),g/=s.x,t.left=i(t.left,g)}if(e&d.RIGHT){var m=(1-l.x)*u.width;m+=r.x,g=(m*=s.x)-(p.x+(1-_.x)*c.width*f.x),t.isAbsoluteRight||(g/=u.width),g/=s.x,t.right=i(t.right,g)}if(e&d.TOP){var T=(1-l.y)*u.height;T+=r.y,g=(T*=s.y)-(p.y+(1-_.y)*c.height*f.y),t.isAbsoluteTop||(g/=u.height),g/=s.y,t.top=i(t.top,g)}if(e&d.BOT){var v=-l.y*u.height;v+=r.y,v*=s.y,g=p.y-_.y*c.height*f.y-v,t.isAbsoluteBottom||(g/=u.height),g/=s.y,t.bottom=i(t.bottom,g)}}},updateAlignment:function t(e){var i=e.parent;i&&X.isNode(i)&&t(i);var o=e.getComponent(Nt);o&&i&&Ic(e,o)},AlignMode:kt,AlignFlags:Ut});St.on(Et.EVENT_INIT,(function(){Vc.init()})),t("k",(Rc=o("cc.SafeArea"),Bc=u(),Mc=q(110),Hc=_(),Nc=K(Nt),Rc(kc=Bc(kc=Mc(kc=r(kc=Hc(kc=Nc(kc=function(t){function e(){return t.apply(this,arguments)||this}s(e,t);var i=e.prototype;return i.onEnable=function(){this.updateArea(),J.on("canvas-resize",this.updateArea,this)},i.onDisable=function(){J.off("canvas-resize",this.updateArea,this)},i.updateArea=function(){var t=this.node.getComponent(Nt),e=this.node.getComponent(Q);if(t&&e){t.updateAlignment();var i=this.node.position,o=e.anchorPoint;t.isAlignTop=t.isAlignBottom=t.isAlignLeft=t.isAlignRight=!0;var n=C.winSize.width,r=C.winSize.height,s=O.getSafeAreaRect();t.top=r-s.y-s.height,t.bottom=s.y,t.left=s.x,t.right=n-s.x-s.width,t.updateAlignment();var a=this.node.position,h=o.x-(a.x-i.x)/e.width,l=o.y-(a.y-i.y)/e.height;e.setAnchorPoint(h,l),Vc.add(t)}},e}(T))||kc)||kc)||kc)||kc)||kc)||kc)),t("l",(Uc=o("cc.UICoordinateTracker"),Gc=u(),Wc=_(),jc=q(110),Xc=n(X),Yc=d(),Zc=n(Wt),$c=d(),qc=d(),Kc=d(),Qc=n([vt]),Jc=d(),Uc(tu=Gc(tu=Wc(tu=jc((au=function(t){function e(){for(var e,i=arguments.length,o=new Array(i),n=0;n<i;n++)o[n]=arguments[n];return e=t.call.apply(t,[this].concat(o))||this,y(e,"syncEvents",iu,m(e)),y(e,"_target",ou,m(e)),y(e,"_camera",nu,m(e)),y(e,"_useScale",ru,m(e)),y(e,"_distance",su,m(e)),e._transformPos=new h,e._viewPos=new h,e._canMove=!0,e._lastWPos=new h,e._lastCameraPos=new h,e}s(e,t);var i=e.prototype;return i.onEnable=function(){this._checkCanMove()},i.update=function(){var t=this.node.worldPosition,e=this._camera;if(this._canMove&&e&&e.camera&&(!this._lastWPos.equals(t)||!this._lastCameraPos.equals(e.node.worldPosition))&&(this._lastWPos.set(t),this._lastCameraPos.set(e.node.worldPosition),e.camera.update(),e.convertToUINode(t,this._target,this._transformPos),this._useScale&&h.transformMat4(this._viewPos,this.node.worldPosition,e.camera.matView),this.syncEvents.length>0)){var i=this._distance/Math.abs(this._viewPos.z);vt.emitEvents(this.syncEvents,this._transformPos,i)}},i._checkCanMove=function(){this._canMove=!(!this._camera||!this._target)},l(e,[{key:"target",get:function(){return this._target},set:function(t){this._target!==t&&(this._target=t,this._checkCanMove())}},{key:"camera",get:function(){return this._camera},set:function(t){this._camera!==t&&(this._camera=t,this._checkCanMove())}},{key:"useScale",get:function(){return this._useScale},set:function(t){this._useScale!==t&&(this._useScale=t)}},{key:"distance",get:function(){return this._distance},set:function(t){this._distance!==t&&(this._distance=t)}}]),e}(T),c((eu=au).prototype,"target",[Xc,Yc],Object.getOwnPropertyDescriptor(eu.prototype,"target"),eu.prototype),c(eu.prototype,"camera",[Zc,$c],Object.getOwnPropertyDescriptor(eu.prototype,"camera"),eu.prototype),c(eu.prototype,"useScale",[qc],Object.getOwnPropertyDescriptor(eu.prototype,"useScale"),eu.prototype),c(eu.prototype,"distance",[Kc],Object.getOwnPropertyDescriptor(eu.prototype,"distance"),eu.prototype),iu=c(eu.prototype,"syncEvents",[Qc,v,Jc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ou=c(eu.prototype,"_target",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),nu=c(eu.prototype,"_camera",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ru=c(eu.prototype,"_useScale",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),su=c(eu.prototype,"_distance",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),tu=eu))||tu)||tu)||tu)||tu));var Uc,Gc,Wc,jc,Xc,Yc,Zc,$c,qc,Kc,Qc,Jc,tu,eu,iu,ou,nu,ru,su,au,hu,lu=[Z.TOUCH_START,Z.TOUCH_END,Z.TOUCH_MOVE,Z.MOUSE_DOWN,Z.MOUSE_MOVE,Z.MOUSE_UP,Z.MOUSE_ENTER,Z.MOUSE_LEAVE,Z.MOUSE_WHEEL];function cu(t){t.propagationStopped=!0}t("m",o("cc.BlockInputEvents")(hu=u()(hu=_()(hu=function(t){function e(){return t.apply(this,arguments)||this}s(e,t);var i=e.prototype;return i.onEnable=function(){for(var t=0;t<lu.length;t++)this.node.on(lu[t],cu,this)},i.onDisable=function(){for(var t=0;t<lu.length;t++)this.node.off(lu[t],cu,this)},e}(T))||hu)||hu)||hu),t("a",(uu=o("cc.LabelShadow"),_u=u(),pu=q(110),du=_(),fu=K(Yt),gu=d(),yu=d(),mu=d(),uu(Tu=_u(Tu=pu(Tu=du(Tu=fu(Tu=r((Eu=function(t){function e(){for(var e,i=arguments.length,o=new Array(i),n=0;n<i;n++)o[n]=arguments[n];return e=t.call.apply(t,[this].concat(o))||this,y(e,"_color",bu,m(e)),y(e,"_offset",Su,m(e)),y(e,"_blur",Cu,m(e)),e}s(e,t);var i=e.prototype;return i.onEnable=function(){this._updateRenderData()},i.onDisable=function(){this._updateRenderData()},i._updateRenderData=function(){var t=this.node.getComponent(Yt);t&&t.updateRenderData(!0)},l(e,[{key:"color",get:function(){return this._color},set:function(t){this._color!==t&&(this._color.set(t),this._updateRenderData())}},{key:"offset",get:function(){return this._offset},set:function(t){this._offset=t,this._updateRenderData()}},{key:"blur",get:function(){return this._blur},set:function(t){this._blur=t,this._updateRenderData()}}]),e}(T),bu=c((vu=Eu).prototype,"_color",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new e(0,0,0,255)}}),Su=c(vu.prototype,"_offset",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new D(2,2)}}),Cu=c(vu.prototype,"_blur",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),c(vu.prototype,"color",[gu],Object.getOwnPropertyDescriptor(vu.prototype,"color"),vu.prototype),c(vu.prototype,"offset",[yu],Object.getOwnPropertyDescriptor(vu.prototype,"offset"),vu.prototype),c(vu.prototype,"blur",[mu],Object.getOwnPropertyDescriptor(vu.prototype,"blur"),vu.prototype),Tu=vu))||Tu)||Tu)||Tu)||Tu)||Tu)||Tu));var uu,_u,pu,du,fu,gu,yu,mu,Tu,vu,bu,Su,Cu,Eu,Ou,wu,Lu,Au,Du,Pu,xu,Iu,zu,Ru,Bu,Mu,Hu=t("n",(Ou=o("cc.SubContextView"),wu=u(),Lu=q(110),Au=K(Q),Du=_(),Pu=d(),xu=d(),Ou(Iu=wu(Iu=Lu(Iu=Au(Iu=Du((Mu=function(t){function e(){var e;return e=t.call(this)||this,y(e,"_fps",Ru,m(e)),e._sprite=void 0,e._imageAsset=void 0,e._updatedTime=0,e._updateInterval=0,e._openDataContext=void 0,e._content=void 0,y(e,"_designResolutionSize",Bu,m(e)),e._content=new Dt("content"),e._sprite=null,e._imageAsset=new Tt,e._openDataContext=null,e._updatedTime=performance.now(),e}s(e,t),l(e,[{key:"designResolutionSize",get:function(){return this._designResolutionSize},set:function(){}},{key:"fps",get:function(){return this._fps},set:function(t){this._fps!==t&&(this._fps=t,this._updateInterval=1e3/t)}}]);var i=e.prototype;return i.onLoad=function(){window.__globalAdapter&&__globalAdapter.getOpenDataContext?(this._updateInterval=1e3/this._fps,this._openDataContext=__globalAdapter.getOpenDataContext(),this._initSharedCanvas(),this._initContentNode(),this._updateSubContextView()):this.enabled=!1},i.onEnable=function(){this._registerNodeEvent()},i.onDisable=function(){this._unregisterNodeEvent()},i._initSharedCanvas=function(){if(this._openDataContext){var t=this._openDataContext.canvas;t.width=this._designResolutionSize.width,t.height=this._designResolutionSize.height}},i._initContentNode=function(){if(this._openDataContext){var t=this._openDataContext.canvas,e=this._imageAsset;if(e.reset(t),e._texture.create(t.width,t.height),this._sprite=this._content.getComponent(Xt),this._sprite||(this._sprite=this._content.addComponent(Xt)),this._sprite.spriteFrame)this._sprite.spriteFrame.texture=this._imageAsset._texture;else{var i=new Y;i.texture=this._imageAsset._texture,this._sprite.spriteFrame=i}this._content.parent=this.node}},i._updateSubContextView=function(){if(this._openDataContext&&__globalAdapter&&__globalAdapter.getSystemInfoSync){var t=this.node.getComponent(Q),e=this._content.getComponent(Q),i=t.width/e.width,o=t.height/e.height,n=i>o?o:i;e.width=e.width*n,e.height=e.height*n;var r=__globalAdapter.getSystemInfoSync(),s=e.getBoundingBoxToWorld(),a=J.getVisibleSize(),h=r.screenWidth*(s.x/a.width),l=r.screenHeight*(s.y/a.height),c=r.screenWidth*(s.width/a.width),u=r.screenHeight*(s.height/a.height);this._openDataContext.postMessage({fromEngine:!0,type:"engine",event:"viewport",x:h,y:l,width:c,height:u})}},i._updateSubContextTexture=function(){var t=this._imageAsset;if(t&&this._openDataContext&&!(t.width<=0||t.height<=0)){var e=this._openDataContext.canvas;t.reset(e),(e.width>t.width||e.height>t.height)&&this._imageAsset._texture.create(e.width,e.height),this._imageAsset._texture.uploadData(e)}},i._registerNodeEvent=function(){this.node.on(X.EventType.TRANSFORM_CHANGED,this._updateSubContextView,this),this.node.on(X.EventType.SIZE_CHANGED,this._updateSubContextView,this)},i._unregisterNodeEvent=function(){this.node.off(X.EventType.TRANSFORM_CHANGED,this._updateSubContextView,this),this.node.off(X.EventType.SIZE_CHANGED,this._updateSubContextView,this)},i.update=function(t){void 0===t?this._updateSubContextTexture():performance.now()-this._updatedTime>=this._updateInterval&&(this._updatedTime+=this._updateInterval,this._updateSubContextTexture())},e}(T),c((zu=Mu).prototype,"designResolutionSize",[Pu],Object.getOwnPropertyDescriptor(zu.prototype,"designResolutionSize"),zu.prototype),c(zu.prototype,"fps",[xu],Object.getOwnPropertyDescriptor(zu.prototype,"fps"),zu.prototype),Ru=c(zu.prototype,"_fps",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 60}}),Bu=c(zu.prototype,"_designResolutionSize",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new L(640,960)}}),Iu=zu))||Iu)||Iu)||Iu)||Iu)||Iu));C.SubContextView=Hu}}}));
